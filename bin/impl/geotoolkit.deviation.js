/* eslint-disable */
import {L,Fb,N,G,D,W,Rg,uh,U,Si,wh,X,Kd,Fh,hb,vd,Ti,Qj,ek,Xg,wc,fH,Hd,Bd,Fd,Dd,uf,Ui,Rh,jc,nc,ep,Ne,ze,Uh,mc,Y,Hg,xb,O,xm,ff,ni,Bk,Fi,Um,rf,ho,rb,Zd,ye,ta} from './geotoolkit.base.js';import {PR,QR,SR,YR,RR,kU} from './geotoolkit.controls.js';var ca,ha=ha||{};ha.scope={};ha.WDc=function(d){var a=0;return function(){return a<d.length?{done:!1,value:d[a++]}:{done:!0}}};ha.uJe=function(d){return{next:ha.WDc(d)}};ha.obd=!1;ha.N9d=!1;ha.O9d=!1;ha.jAe=!1;ha.noc=!1;ha.defineProperty=ha.obd||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,a,b){if(d==Array.prototype||d==Object.prototype)return d;d[a]=b.value;return d};
ha.I1=function(d){d=["object"==typeof globalThis&&globalThis,d,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<d.length;++a){var b=d[a];if(b&&b.Math==Math)return b}return function(){throw Error("Cannot find global object");}()};ha.global=ha.I1(this);ha.TMb="function"===typeof Symbol&&"symbol"===typeof Symbol("x");ha.FDe=!ha.noc||ha.TMb;ha.$cc={};ha.wdc={};ha.Chd="$jscp$";
function aaa(d,a){var b=ha.wdc[a];if(null==b)return d[a];b=d[b];return void 0!==b?b:d[a]}ha.LYc=function(d,a,b,c){a&&(ha.noc?ha.aWd(d,a,b,c):ha.bWd(d,a,b,c))};ha.bWd=function(d,a,b,c){b=ha.global;d=d.split(".");for(c=0;c<d.length-1;c++){var e=d[c];if(!(e in b))return;b=b[e]}d=d[d.length-1];c=b[d];a=a(c);a!=c&&null!=a&&ha.defineProperty(b,d,{configurable:!0,writable:!0,value:a})};
ha.aWd=function(d,a,b,c){var e=d.split(".");d=1===e.length;c=e[0];c=!d&&c in ha.$cc?ha.$cc:ha.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in c))return;c=c[g]}e=e[e.length-1];b=ha.TMb&&"es6"===b?c[e]:null;a=a(b);null!=a&&(d?ha.defineProperty(ha.$cc,e,{configurable:!0,writable:!0,value:a}):a!==b&&(ha.wdc[e]=ha.TMb?ha.global.Symbol(e):ha.Chd+e,e=ha.wdc[e],ha.defineProperty(c,e,{configurable:!0,writable:!0,value:a})))};ha.oNe=function(){};
ha.LYc("Symbol",function(d){function a(f){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new b(c+(f||"")+"_"+e++,f)}function b(f,g){this.lbd=f;ha.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})}if(d)return d;b.prototype.toString=function(){return this.lbd};var c="jscomp_symbol_",e=0;return a},"es6","es3");ha.qNe=function(){};
ha.LYc("Symbol.iterator",function(d){if(d)return d;d=Symbol("Symbol.iterator");for(var a="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<a.length;b++){var c=ha.global[a[b]];"function"===typeof c&&"function"!=typeof c.prototype[d]&&ha.defineProperty(c.prototype,d,{configurable:!0,writable:!0,value:function(){return ha.NQd(ha.WDc(this))}})}return d},"es6","es3");ha.pNe=function(){};
ha.NQd=function(d){d={next:d};d[Symbol.iterator]=function(){return this};return d};var YO=/*#__PURE__*/function(){function d(){}L(d,"geotoolkit.deviation.Transformer2d");d.prototype.create=Fb;return d}();var ZO=/*#__PURE__*/function(){function d(){this.dh=[]}L(d,"geotoolkit.deviation.RectMap");d.prototype.aqa=function(){return this.dh};d.prototype.clear=function(){this.dh=[];return this};d.prototype.wZa=function(a){for(var b=0;b<this.dh.length;b++){var c=this.dh[b];if(a<=c.Wmb)return b}return this.dh.length};d.prototype.c9d=function(a){for(var b=this.dh.length-1;0<=b;b--)if(this.dh[b].Wmb<=a)return b;return 0};d.prototype.vo=function(a){var b=a.Wmb;if(0===this.dh.length)this.dh.push(a);else{var c;for(c=0;c<this.dh.length&&
!(this.dh[c].Wmb>=b);c++);this.dh.splice(c,0,a)}};return d}();var $O=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){}L(d,"geotoolkit.deviation.DeviatedTransformation");d.prototype.update=Fb;d.prototype.transform=Fb;d.prototype.sc=Fb;d.prototype.tG=Fb;d.prototype.bK=Fb;d.prototype.iya=Fb;d.prototype.zWa=Fb;d.prototype.sza=Fb;d.prototype.contains=Fb;d.prototype.kZ=Fb;d.prototype.lZ=Fb;d.prototype.pRc=function(){return{xMin:this.WU(),yMin:this.XU(),xMean:this.REb(),yMean:this.SEb(),xMax:this.QY(),yMax:this.RY()}};d.prototype.QY=Fb;d.prototype.RY=Fb;d.prototype.WU=Fb;d.prototype.XU=Fb;
d.prototype.REb=function(){var a=this.WU(),b=this.QY();return Math.sqrt((a*a+b*b)/2)};d.prototype.SEb=function(){var a=this.XU(),b=this.RY();return Math.sqrt((a*a+b*b)/2)};d.prototype.Maa=Fb;d.prototype.Q1=Fb;return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoic2MiLCJ0cmFuc2Zvcm1MaW5lIjoidEciLCJ0cmFuc2Zvcm1MaW5lcyI6ImJLIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiaXlhIiwiZmluZEJvdW5kcyI6InpXYSIsImdldFN0YXRpb25zQm91bmRzIjoic3phIiwic2NhbGVYQXQiOiJrWiIsInNjYWxlWUF0IjoibFoiLCJnZXRTY2FsZXNJbmZvIjoicFJjIiwibWF4U2NhbGVYIjoiUVkiLCJtYXhTY2FsZVkiOiJSWSIsIm1pblNjYWxlWCI6IldVIiwibWluU2NhbGVZIjoiWFUiLCJkaWdpdGl6ZSI6Ik1hYSIsImdldExvd2VySW5kZXgiOiJRMSJ9fX0g");var aP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){}L(d,"geotoolkit.deviation.TrackWidthStrategy");d.prototype.ca=Fb;d.prototype.A6b=function(a,b){if(2>a.count())return{deviceLength:0,length:0};var c=0,e=0,f=new N,g=new N;b.Ma(f.Da(a.getX(0),a.getY(0)),g);for(var h=g.x,k=g.y,l,m,n=1;n<a.count();++n)b.Ma(f.Da(a.getX(n),a.getY(n)),g),l=g.x,m=g.y,h-=l,k-=m,c+=Math.sqrt(h*h+k*k),k=m,h=l,l=Math.abs(a.Ub(n-1)-a.Ub(n)),e+=l;return{deviceLength:c,length:e}};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIiwiZ2V0RGV2aWNlTGVuZ3RoIjoiQTZiIn19fSAg");var bP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(b){aP.call(this);b=G(b,{scaleWidth:!1,minWidth:1,maxWidth:Infinity,widthScaleX:1,widthScaleY:1});this.HYb=b.scaleWidth;this.PW=b.minWidth;this.JW=b.maxWidth;this.ixb=b.widthScaleX;this.t0b=b.widthScaleY;this.Aq=null;this.BDa=1}function a(b,c){return Math.abs(c)>Math.abs(b)?0>c?-Math.atan(b/c):Math.PI-Math.atan(b/c):0>b?-Math.PI/2+Math.atan(c/b):Math.PI/2+Math.atan(c/b)}D(d,aP);L(d,"geotoolkit.deviation.TrackMinMaxWidthStrategy");d.prototype.ca=function(b,c){var e=c.width;
if(!this.HYb)return e;c=c.trajectory;c!==this.Aq&&(this.update(c),this.Aq=c);b=Math.sqrt(b.lb()/this.ixb*this.BDa*(b.lb()/this.ixb)+(1-this.BDa)*(b.Ab()/this.t0b)*(b.Ab()/this.t0b));e*=b;e<this.PW&&(e=this.PW);e>this.JW&&(e=this.JW);return e};d.prototype.update=function(b){this.BDa=1;for(var c=0,e=0,f=0,g,h,k=1;k<b.count();++k)g=this.ixb*(b.getX(f)-b.getX(k)),h=this.t0b*(b.getY(f)-b.getY(k)),1<k&&k<b.count()-1&&.5>Math.abs(g)&&.5>Math.abs(h)?k++:(e+=Math.abs(a(g,h)),c++,f=k);0<c&&(e/=c);this.BDa=
Math.sin(e);this.BDa*=this.BDa};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIn19fSAg");var cP=/*#__PURE__*/function(){function d(b){return 0<=b?Math.floor(b+.5):Math.ceil(b-.5)}function a(){}L(a,"geotoolkit.deviation.Util");a.gG=function(b){return 0>b?Math.ceil(b):Math.floor(b)};a.uMa=function(b,c){return b.getX()*c.getX()+b.getY()*c.getY()};a.m9d=function(b,c){return b.getX()*c.getY()-b.getY()*c.getX()};a.d2b=function(b,c,e){var f=(b.getX()-c.getX())*(e.getX()-c.getX())+(b.getY()-c.getY())*(e.getY()-c.getY());b=(b.getX()-c.getX())*(e.getY()-c.getY())-(b.getY()-c.getY())*(e.getX()-c.getX());return 0!==
f||0!==b?Math.atan2(b,f):0};a.Ar=function(b,c,e,f){if(f){if(f=d(c.getX()),c=d(c.getY()),0<Math.abs(e.getX()-f)||0<Math.abs(e.getY()-c))e.Da(f,c),b.push(new N(f,c))}else b.push(c)};a.LTc=function(b,c,e,f,g){var h=0<=(b.getY()-c.getY())*(e.getX()-c.getX())-(b.getX()-c.getX())*(e.getY()-c.getY());return h!==0<=(b.getY()-e.getY())*(f.getX()-e.getX())-(b.getX()-e.getX())*(f.getY()-e.getY())||h!==0<=(b.getY()-f.getY())*(g.getX()-f.getX())-(b.getX()-f.getX())*(g.getY()-f.getY())||h!==0<=(b.getY()-g.getY())*
(c.getX()-g.getX())-(b.getX()-g.getX())*(c.getY()-g.getY())?!1:!0};a.Koa=function(b,c,e,f,g){var h=(f.getY()-e.getY())*(c.getX()-b.getX())-(f.getX()-e.getX())*(c.getY()-b.getY());return 0!==h?(f=((f.getX()-e.getX())*(b.getY()-e.getY())-(f.getY()-e.getY())*(b.getX()-e.getX()))/h,e=b.getY()+f*(c.getY()-b.getY()),b=b.getX()+f*(c.getX()-b.getX()),g.Da(b,e),!0):!1};a.VDb=function(b,c,e,f){var g=0<=(b.getY()-c.getY())*(e.getX()-c.getX())-(b.getX()-c.getX())*(e.getY()-c.getY());return g!==0<=(b.getY()-e.getY())*
(f.getX()-e.getX())-(b.getX()-e.getX())*(f.getY()-e.getY())||g!==0<=(b.getY()-f.getY())*(c.getX()-f.getX())-(b.getX()-f.getX())*(c.getY()-f.getY())?!1:!0};a.getLength=function(b){return Math.abs(b.getX())<=Number.MIN_VALUE?Math.abs(b.getY()):Math.abs(b.getY())<=Number.MIN_VALUE?Math.abs(b.getX()):Math.sqrt(b.getX()*b.getX()+b.getY()*b.getY())};a.KYc=function(b){var c=b?b.length:0;return 2>c?!0:N.xf(b[0],b[c-1])<W.Tb};a.GR=function(b,c,e){b=b.getY()===c.getY()?(b.getX()+c.getX())/2:b.getX()+(c.getX()-
b.getX())*(e-b.getY())/(c.getY()-b.getY());return new N(b,e)};a.P$b=function(b,c,e,f){void 0===f&&(f=W.Tb);var g=c.getY()-b.getY();if(0===g)return Math.abs(b.getY()-e.getY())<=f;var h=c.getX()-b.getX();return 0===h?Math.abs(b.getX()-e.getX())<=f:Math.abs(b.getX()+(c.getX()-b.getX())*(e.getY()-b.getY())/g-e.getX())<=f||Math.abs(b.getY()+(c.getY()-b.getY())*(e.getX()-b.getX())/h-e.getY())<=f?!0:!1};a.FGc=function(b,c,e,f,g,h,k){if(0>=k)throw Error("Invalid radius");var l=b-e,m=c-f;l=Math.atan2(m,l);
g-=e;h-=f;h=Math.atan2(h,g);m=h-l;g=-Math.sign(m);if(Math.abs(m)<=Number.MIN_VALUE)throw Error("Invalid angles");var n=Math.abs(m/2),p=k/Math.sin(n);m=p*Math.cos((l+h)/2);var q=p*Math.sin((l+h)/2),r=p*Math.cos(n);n=r*Math.cos(l);p=r*Math.sin(l);var t=r*Math.cos(h);r*=Math.sin(h);return{line:{E9d:b,G9d:c,fbd:g*n+e,ibd:g*p+f},arc:{left:g*m+e-k,top:g*q+f-k,bx:l+Math.PI/2,rJc:h-Math.PI/2},Yp:{x:g*t+e,y:g*r+f}}};a.UBd=function(b,c,e,f){var g=f||a.pJd(b,c);if(0===g.length)return[];if(1===g.length)return a.DQc(b,
c,e);f=[];var h;for(h=0;h<g.length;++h){var k=b.slice(g[h].from,g[h].Re+1);var l=c.slice(g[h].from,g[h].Re+1);k=a.DQc(k,l,e);for(l=0;l<k.length;++l)f.push(k[l].from),f.push(k[l].Re)}f.sort(function(m,n){return m-n});b=[];for(h=0;h<f.length;h+=2)b.push({from:f[h],Re:f[h+1]});return b};a.pJd=function(b,c){for(var e=Math.min(b.length,c.length),f=[],g,h,k,l,m=0;m<e;++m){g=b[m];h=c[m];for(var n=m+2;n<e;++n)if(k=b[n],l=c[n],g===k&&h===l){f.push({from:m,Re:n});m=n;break}}0===f.length&&f.push({from:0,Re:f.length-
1});return f};a.DQc=function(b,c,e){var f=[],g=Math.min(b.length,c.length),h=[],k;for(k=1;k<g;++k)if(!(c[k]===c[k-1]||c[k]<e&&c[k-1]<e||c[k]>e&&c[k-1]>e)){if(c[k-1]>c[k]){var l=c[k];var m=c[k-1];var n=b[k];var p=b[k-1]}else l=c[k-1],m=c[k],n=b[k-1],p=b[k];l!==e&&(n=n===p?p:n+(e-l)*(p-n)/(m-l),h.push(n))}if(2>h.length)return f;h.sort(function(q,r){return q-r});for(k=0;k<h.length;k+=2)f.push({from:h[k],Re:h[k+1]});return f};a.kZc=function(b,c){return Math.abs(b-c)<=1E-12*Math.min(Math.abs(b),Math.abs(c))};
return a}();var dP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){}L(d,"geotoolkit.deviation.ClipHelper");d.PKa=function(a,b){for(var c=new Rg,e=new Rg,f=0;f<a.length-1;++f){c.setStart(a[f]);c.setEnd(a[f+1]);for(var g=0;g<b.length-1;++g){e.setStart(b[g]);e.setEnd(b[g+1]);var h=c.dpa(e);if(h)return h}}return null};return d}(),2,"eyJpbnRlcnNlY3RMaW5lcyI6IlBLYSJ9");var eP=/*#__PURE__*/function(){function d(b,c){this.sEa=NaN;this.b0=new N;this.Cr(b,c)}var a=new N;L(d,"geotoolkit.deviation.Line");d.prototype.Cr=function(b,c){if("number"===typeof c)this.b0.Da(b.getX(),b.getY()),this.sEa=c;else if(c instanceof N){a.Da(c.getY()-b.getY(),b.getX()-c.getX());c=cP.uMa(a,a);if(c>W.Tb){var e=Math.sqrt(c);c=a.getX()/e;e=a.getY()/e}else c=1,e=0;this.b0.Da(c,e);this.sEa=-cP.uMa(this.b0,b)}else this.sEa=b.sEa,this.b0.Da(b.b0.getX(),b.b0.getY())};d.prototype.aFb=function(){return this.b0};
d.prototype.CQe=function(b){this.b0=b};d.prototype.vcb=function(){return this.sEa};d.prototype.BQe=function(b){this.sEa=b};d.prototype.distance=function(b){return cP.uMa(this.b0,b)+this.sEa};d.prototype.project=function(b){var c=this.distance(b);return new N(b.getX()-this.b0.getX()*c,b.getY()-this.b0.getY()*c)};d.prototype.GOe=function(b){var c=2*this.distance(b);return new N(b.getX()-this.b0.getX()*c,b.getY()-this.b0.getY()*c)};d.Ysd=function(b,c){b=b.aFb();c=c.aFb();return Math.abs(b.getX()*c.getY()-
c.getX()*b.getY())<W.Tb};d.QZc=function(b,c){var e=b.aFb(),f=c.aFb(),g=e.getX()*f.getY()-f.getX()*e.getY();b=b.vcb();var h=c.vcb();c=e.getY()*h-f.getY()*b;e=f.getX()*b-e.getX()*h;return new N(c/g,e/g)};return d}();var fP=/*#__PURE__*/function(){function d(){this.gna=[]}L(d,"geotoolkit.deviation.MappedPixel");d.prototype.clear=function(){this.gna=[]};d.prototype.append=function(a){this.gna.push(a)};d.prototype.get=function(a){return this.gna[a]};d.prototype.getSize=function(){return this.gna.length};return d}();var gP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){this.BFa=[]}function a(p){var q=p.getSize(),r=p.be();p=p.He();var t=0===q||r[0]===r[q-1]&&p[0]===p[q-1];if(q<(t?4:3))return 0;for(var u=0,w=1;w<q;++w)u+=r[w-1]*p[w]-p[w-1]*r[w];t||(u+=r[q-1]*p[0]-p[q-1]*r[0]);return Math.abs(u/2)}function b(p,q,r){this.gi=p;this.Vh=q;this.area=r}var c=cP,e=8;L(d,"geotoolkit.deviation.PixelMapper");d.prototype.sc=Fb;var f=new N,g=new N,h=new N,k=new N,l=new uh,m=new uh,n=new U;d.prototype.E8d=function(p,q,r){var t=p.getX();p=p.getY();
t=[this.sc(f.Da(t,p)),this.sc(g.Da(t+1,p)),this.sc(h.Da(t+1,p+1)),this.sc(k.Da(t,p+1))];t.forEach(function(B){B.y*=r});p=0>t[0].x?1-c.gG(t[0].x):-c.gG(t[0].x);for(var u=0>t[0].y?1-c.gG(t[0].y):-c.gG(t[0].y),w=Infinity,y=-Infinity,z=Infinity,x=-Infinity,C=0;C<t.length;C++)t[C].x+=p,t[C].y+=u,w=Math.min(w,t[C].x),y=Math.max(y,t[C].x),z=Math.min(z,t[C].y),x=Math.max(x,t[C].y);p=new fP;if(Si.Uo().zA(n.cb(w,z,y,x)))t=0,u=x-z,C=y-w,t+=u*w,t+=-C*x,t+=-u*y,t+=C*z,p.append(new b(0,0,t));else for(u=c.gG(t[0].x),
C=c.gG(t[0].y),w=Math.floor(w),y=Math.ceil(y),z=Math.floor(z),x=Math.ceil(x);w<y;++w)for(var A=z;A<x;++A){var v=new wh;v.union(l.ne([t[0].x,t[1].x,t[2].x,t[3].x],[t[0].y,t[1].y,t[2].y,t[3].y]),v);v=v.intersect(m.ne([w,w+1,w+1,w],[A,A,A+1,A+1]));0<v.length&&p.append(new b(w-u,A-C,a(v[0])))}this.BFa[q]=p};d.prototype.tbc=function(p,q){var r=this.sc(p),t=r.getX()-(0>r.getX()?c.gG(r.getX())-1:c.gG(r.getX())),u=r.getY()-(0>r.getY()?c.gG(r.getY())-1:c.gG(r.getY()));t=c.gG(t*e)+c.gG(u*e)*e;this.BFa[t]&&
0!==this.BFa[t].getSize()||this.E8d(p,t,q);this.BFa[t].xg=r;return this.BFa[t]};d.prototype.u2b=function(){for(var p=0;p<this.BFa.length;++p)this.BFa[p].clear()};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoic2MifX19");var hP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a,b){gP.call(this);this.LF=a;this.pFa=new N;this.TGa=new N;this.QGa=new N;this.mFa=new N;this.iT=this.hT=1;this.YXb=null;this.$vc=b}D(d,gP);L(d,"geotoolkit.deviation.TrajectoryStation");d.prototype.kd=function(){return this.pFa};d.prototype.Rgc=function(a){this.pFa.Da(a.getX(),a.getY())};d.prototype.dg=function(){return this.mFa};d.prototype.Ogc=function(a){this.mFa.Da(a.getX(),a.getY())};d.prototype.fg=function(){return this.TGa};d.prototype.Mhc=function(a){this.TGa.Da(a.getX(),
a.getY())};d.prototype.yf=function(){return this.QGa};d.prototype.Ihc=function(a){this.QGa.Da(a.getX(),a.getY())};d.prototype.Gf=function(){return this.LF.la()};d.prototype.$gc=function(a){a=Math.min(this.LF.ma(),a);this.LF.cb(this.LF.ka(),a,this.LF.na(),this.LF.ma());this.update()};d.prototype.vg=function(){return this.LF.ma()};d.prototype.Ygc=function(a){a=Math.max(this.LF.la(),a);this.LF.cb(this.LF.ka(),this.LF.la(),this.LF.na(),a);this.update()};d.prototype.Sf=function(){return this.LF};d.prototype.pBa=
function(a){this.LF=a};d.prototype.ga=function(){var a=new U(this.kd().getX(),this.kd().getY(),this.dg().getX(),this.dg().getY());return a.union(new U(this.yf().getX(),this.yf().getY(),this.fg().getX(),this.fg().getY()))};d.prototype.QY=function(){return this.hT};d.prototype.TMa=function(a){this.hT=a};d.prototype.RY=function(){return this.iT};d.prototype.UMa=function(a){this.iT=a};d.prototype.Zba=function(){return this.$vc};d.prototype.BWd=function(a){this.YXb=a};d.prototype.offset=function(a){var b=
a.getX();a=a.getY();this.pFa.Da(this.pFa.getX()+b,this.pFa.getY()+a);this.TGa.Da(this.TGa.getX()+b,this.TGa.getY()+a);this.QGa.Da(this.QGa.getX()+b,this.QGa.getY()+a);this.mFa.Da(this.mFa.getX()+b,this.mFa.getY()+a)};d.prototype.update=function(){this.u2b()};d.prototype.Maa=function(a,b){if(this.$vc&&null!=this.YXb){var c=this.sc(a),e=this.LF.ma(),f=this.LF.la();e-=f;c=(c.y-f)/e;a=0>c?this.YXb.Maa(a,b):this.tbc(a,b)}else a=this.tbc(a,b);return a};d.prototype.JY=function(){var a=(this.pFa.x+this.TGa.x)/
2,b=(this.pFa.y+this.TGa.y)/2,c=(this.mFa.x+this.QGa.x)/2,e=(this.mFa.y+this.QGa.y)/2;return Math.sqrt((a-c)*(a-c)+(b-e)*(b-e))};d.prototype.contains=function(a,b,c){var e=new N,f=this.Sf();if(0<=a.Gaa(this.kd(),this.fg(),e,e)&&0<=a.Gaa(this.dg(),this.yf(),e,e))return b>f.la()&&(b=f.la()),c<f.ma()&&(c=f.ma()),{Zf:b,Yf:c,contain:!0};var g=this.sc(a.kd()),h=this.sc(a.fg());e=this.sc(a.yf());a=this.sc(a.dg());g=new U(g.getX(),g.getY(),h.getX(),h.getY());g.union(new U(e.getX(),e.getY(),a.getX(),a.getY()));
g.intersect(f);return g.isEmpty()?{Zf:b,Yf:c,contain:!1}:(b>g.la()&&(b=g.la()),c<g.ma()&&(c=g.ma()),{Zf:b,Yf:c,contain:!0})};d.prototype.transform=Fb;d.prototype.tG=Fb;d.prototype.RBa=Fb;d.prototype.kZ=Fb;d.prototype.lZ=Fb;return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1MaW5lIjoidEciLCJ0cmFuc2Zvcm1MaW5lUmV2IjoiUkJhIiwic2NhbGVYQXQiOiJrWiIsInNjYWxlWUF0IjoibFoifX19");var iP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(e,f,g){var h=(g-f)/100;if(f<=e&&e<=g)return e;if(e<f){if(f-e<h)return f}else if(e-g<h)return g;return NaN}function a(e,f,g){hP.call(this,f,g);this.YM=null;this.ad=new X;null!=e&&this.ad.Sb(e);this.Qm=new X;this.xz=new N;this.mB=new N;this.KWb=2;this.ona=new N}var b=cP,c=eP;D(a,hP);L(a,"geotoolkit.deviation.LinearTrajectoryStation");a.prototype.HSd=function(){return this.KWb};a.prototype.ezb=function(){this.KWb--};a.prototype.mNe=function(){this.KWb++};a.prototype.JY=function(){return N.xf(this.xz,
this.mB)};a.prototype.C6d=function(){return this.xz};a.prototype.Zzd=function(){return this.mB};a.prototype.k2=function(){return this.YM=this.YM||this.ad.xc()};a.prototype.Ea=function(){return this.ad};a.prototype.Sb=function(e){this.ad.Sb(e);this.YM=null;this.u2b()};a.prototype.tQe=function(e){this.Qm.Sb(e)};a.prototype.offset=function(e){hP.prototype.offset.call(this,e);var f=e.getX();e=e.getY();this.ad.TA(this.ad.cf()+f,this.ad.Pe()+e);this.Zba()&&this.Qm.TA(this.Qm.cf()+f,this.Qm.Pe()+e);this.YM=
null;this.xz.Da(this.xz.getX()+f,this.xz.getY()+e);this.mB.Da(this.mB.getX()+f,this.mB.getY()+e)};a.prototype.contains=function(e,f,g){if(e instanceof U)return hP.prototype.contains.call(this,e,f,g);if(!this.Zba()){g=this.k2().Ma(e);var h=this.Sf();if(h.contains(g))return f&&f.Da(g.getX(),g.getY()),!0;e=d(g.getX(),h.ka(),h.na());if(!W.Hq(e))return!1;g=d(g.getY(),h.la(),h.ma());if(!W.Hq(g))return!1;f&&f.Da(e,g);return!0}if(this.kd().getY()<=this.dg().getY()===this.fg().getY()<=this.yf().getY())return b.LTc(e,
this.dg(),this.yf(),this.fg(),this.kd());f=new N;return b.Koa(this.kd(),this.fg(),this.dg(),this.yf(),f)?b.VDb(e,this.kd(),this.dg(),f)||b.VDb(e,this.fg(),this.yf(),f):!1};a.prototype.sc=function(e){if(!this.Zba())return this.k2().Ma(e);var f=new N,g=new N;if(!b.Koa(this.kd(),this.fg(),this.dg(),this.yf(),f)||!b.Koa(this.xz,this.mB,f,e,g))return e.clone();if(g.getY()<Math.min(this.xz.getY(),this.mB.getY()))return this.Sf().kd();if(g.getY()>Math.max(this.xz.getY(),this.mB.getY()))return this.Sf().yf();
f=b.getLength(this.ona.Da(this.mB.getX()-this.xz.getX(),this.mB.getY()-this.xz.getY()));g=Math.abs(f)>W.Tb?b.getLength(this.ona.Da(g.getX()-this.xz.getX(),g.getY()-this.xz.getY()))/f:Number.MAX_VALUE;f=g*this.ad.lb()+(1-g)*this.Qm.lb();e=Math.abs(f)<=W.Tb?Number.MAX_VALUE:(e.getX()-g*(this.ad.Ii()*this.Sf().ma()+this.ad.cf())-(1-g)*(this.Qm.Ii()*this.Sf().la()+this.Qm.cf()))/f;g=g*this.Sf().ma()+(1-g)*this.Sf().la();return new N(e,g)};a.prototype.transform=function(e){if(!this.Zba())return this.ad.Ma(e);
var f=this.Sf().ma(),g=this.Sf().la(),h=f-g;if(Math.abs(h)<W.Tb)return e.getY()<g?this.Qm.Ma(e):this.ad.Ma(e);h=(e.getY()-g)/h;if(0>=h)return this.Qm.Ma(e);if(1<=h)return this.ad.Ma(e);var k=this.Qm.lb()*e.getX()+this.Qm.Ii()*g+this.Qm.cf(),l=this.ad.lb()*e.getX()+this.ad.Ii()*f+this.ad.cf();g=this.Qm.vi()*e.getX()+this.Qm.Ab()*g+this.Qm.Pe();e=this.ad.vi()*e.getX()+this.ad.Ab()*f+this.ad.Pe();return new N((l-k)*h+k,(e-g)*h+g)};a.prototype.update=function(){hP.prototype.update.call(this);this.YM=
null;var e=this.Sf(),f=this.Zba()?this.Qm:this.ad;this.xz=f.Ma(new N(e.hc(),e.la()));this.mB=this.ad.Ma(new N(e.hc(),e.ma()));this.Rgc(f.Ma(e.kd()));this.Mhc(f.Ma(e.fg()));this.Ihc(this.ad.Ma(e.yf()));this.Ogc(this.ad.Ma(e.dg()));0===this.ad.lb()?this.TMa(Math.abs(this.ad.vi())):0===this.ad.vi()?this.TMa(Math.abs(this.ad.lb())):this.TMa(Math.sqrt(this.ad.lb()*this.ad.lb()+this.ad.vi()*this.ad.vi()));0===this.ad.Ab()?this.UMa(Math.abs(this.ad.Ii())):0===this.ad.Ii()?this.UMa(Math.abs(this.ad.Ab())):
this.UMa(Math.sqrt(this.ad.Ab()*this.ad.Ab()+this.ad.Ii()*this.ad.Ii()));this.Zba()&&(0===this.Qm.lb()?this.TMa(Math.max(this.QY(),Math.abs(this.Qm.vi()))):0===this.Qm.vi()?this.TMa(Math.max(this.QY(),Math.abs(this.Qm.lb()))):this.TMa(Math.max(this.QY(),Math.sqrt(this.Qm.lb()*this.Qm.lb()+this.Qm.vi()*this.Qm.vi()))),0===this.Qm.Ab()?this.UMa(Math.max(this.RY(),Math.abs(this.Qm.Ii()))):0===this.Qm.Ii()?this.UMa(Math.max(this.RY(),Math.abs(this.Qm.Ab()))):this.UMa(Math.max(this.RY(),Math.sqrt(this.Qm.Ab()*
this.Qm.Ab()+this.Qm.Ii()*this.Qm.Ii()))))};a.prototype.kZ=function(e){if(!this.Zba())return 0===this.ad.lb()?Math.abs(this.ad.vi()):0===this.ad.vi()?Math.abs(this.ad.lb()):Math.sqrt(this.ad.lb()*this.ad.lb()+this.ad.vi()*this.ad.vi());e=this.FDc(e);return 0===e.lb()?Math.abs(e.vi()):0===e.vi()?Math.abs(e.lb()):Math.sqrt(e.lb()*e.lb()+e.vi()*e.vi())};a.prototype.lZ=function(e){if(!this.Zba())return 0===this.ad.Ab()?Math.abs(this.ad.Ii()):0===this.ad.Ii()?Math.abs(this.ad.Ab()):Math.sqrt(this.ad.Ab()*
this.ad.Ab()+this.ad.Ii()*this.ad.Ii());e=this.FDc(e);return 0===e.Ab()?Math.abs(e.Ii()):0===e.Ii()?Math.abs(e.Ab()):Math.sqrt(e.Ab()*e.Ab()+e.Ii()*e.Ii())};a.prototype.FDc=function(e){if(!this.Zba())return this.ad;var f=this.Sf().ma(),g=this.Sf().la(),h=f-g;if(Math.abs(h)<W.Tb)return e.getY()<g?this.Qm:this.ad;var k=(e.getY()-g)/h;if(0>=k)return this.Qm;if(1<=k)return this.ad;if(Math.abs(e.getY())<=W.Tb){e=this.ad.Ii()*f+this.ad.cf();var l=this.ad.Ab()*f+this.ad.Pe(),m=this.Qm.Ii()*g+this.Qm.cf(),
n=this.Qm.Ab()*g+this.Qm.Pe();return new X(this.ad.lb()*k+this.Qm.lb()*(1-k),this.ad.vi()*k+this.Qm.vi()*(1-k),(e-m)/h,(l-n)/h,(m*f-e*g)/h,(n*f-l*g)/h)}return new X(this.ad.lb()*k+this.Qm.lb()*(1-k),this.ad.vi()*k+this.Qm.vi()*(1-k),(this.ad.Ii()*k*f+this.Qm.Ii()*(1-k)*g)/e.getY(),(this.ad.Ab()*k*f+this.Qm.Ab()*(1-k)*g)/e.getY(),this.ad.cf()*k+this.Qm.cf()*(1-k),this.ad.Pe()*k+this.Qm.Pe()*(1-k))};a.prototype.tG=function(e,f,g,h,k){var l=this.Sf(),m=W.Tb;l.la()<=e.getY()+m&&l.ma()>=e.getY()-m&&b.Ar(h,
this.transform(e),g,k);l.la()>e.getY()-m&&l.la()<f.getY()+m&&b.Ar(h,this.transform(b.GR(e,f,l.la())),g,k);l.ma()>e.getY()-m&&l.ma()<f.getY()+m&&b.Ar(h,this.transform(b.GR(e,f,l.ma())),g,k);l.la()<=f.getY()+m&&l.ma()>=f.getY()-m&&b.Ar(h,this.transform(f),g,k)};a.prototype.RBa=function(e,f,g,h,k){var l=this.Sf();l.la()<=e.getY()&&l.ma()>=e.getY()&&b.Ar(h,this.transform(e),g,k);l.ma()>f.getY()&&l.ma()<e.getY()&&b.Ar(h,this.transform(b.GR(e,f,l.ma())),g,k);l.la()>f.getY()&&l.la()<e.getY()&&b.Ar(h,this.transform(b.GR(e,
f,l.la())),g,k);l.la()<=f.getY()&&l.ma()>=f.getY()&&b.Ar(h,this.transform(f),g,k)};a.a9c=function(e,f,g,h,k,l,m){m=0;if(e.Zba()||f.Zba())return{tooShort:m,rZa:g,zVa:!1};var n=b.m9d(new N(f.dg().getX()-f.kd().getX(),f.dg().getY()-f.kd().getY()),new N(e.dg().getX()-e.kd().getX(),e.dg().getY()-e.kd().getY()));if(Math.abs(n)<W.Tb)return{tooShort:m,rZa:g,zVa:!1};if(g=0>n){n=new c(e.kd(),e.dg());var p=new c(f.kd(),f.dg())}else n=new c(e.fg(),e.yf()),p=new c(f.fg(),f.yf());if(c.Ysd(n,p))return{tooShort:m,
rZa:g,zVa:!1};n=c.QZc(p,n);h.Da(n.getX(),n.getY());n=e.sc(h);k.Da(n.getX(),n.getY());n=f.sc(h);l.Da(n.getX(),n.getY());if(e.Gf()>=k.getY()||f.vg()<=l.getY())return m=e.Gf()>=k.getY()?f.vg()<=l.getY()?-3:-2:-1,{tooShort:m,rZa:g,zVa:!1};e.vg()<k.getY()&&f.Gf()>l.getY()&&(m=1);return{tooShort:m,rZa:g,zVa:!0}};return a}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoic2MiLCJzY2FsZVhBdCI6ImtaIiwic2NhbGVZQXQiOiJsWiIsInRyYW5zZm9ybUxpbmUiOiJ0RyIsInRyYW5zZm9ybUxpbmVSZXYiOiJSQmEifX19");var jP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){hP.call(this,new U,!0);this.Ge=[];this.Uq=this.rl=null;this.n_=0;this.$e=[];this.Cg=[];this.WP=[];this.vT=[];this.Z$=this.j$=0;this.TMa(1);this.UMa(1);this.Bs=[];this.Ib=new N;this.QUb=!1;this.xi=new N;this.sxc=new N;this.txc=new N;this.Rtb=this.Stb=0;this.Va=new U}function a(l,m,n,p,q){return k.Koa(l,m,n,p,q)?b(l,m,q)?b(n,p,q)?3:1:b(n,p,q)?2:0:-1}function b(l,m,n){if(l.getY()<m.getY()){if(n.getY()<l.getY()||n.getY()>m.getY())return!1}else if(n.getY()>l.getY()||n.getY()<
m.getY())return!1;if(l.getX()<m.getX()){if(n.getX()<l.getX()||n.getX()>m.getX())return!1}else if(n.getX()>l.getX()||n.getX()<m.getX())return!1;return!0}function c(l,m){return l.key>=m.key?1:-1}function e(l,m,n,p,q,r,t,u){N.xf(t,m)<N.xf(p,m)||N.xf(t,m)<N.xf(q,m)||(m=f(m,p,q,t,u),0<m&&l.push({key:m,point:t}))}function f(l,m,n,p,q){l=k.d2b(m,l,p);if(0>q){if(0>l&&l>q)return-l}else if(0<l&&l<q)return l;return 0}function g(l,m,n){return new N(h(l,m,n),n)}function h(l,m,n){return Math.abs(l.getY()-n)<=W.Tb?
l.getX():Math.abs(m.getY()-n)<=W.Tb?m.getX():Math.abs(l.getY()-m.getY())<=W.Tb?(l.getX()+m.getX())/2:l.getX()+(m.getX()-l.getX())*(n-l.getY())/(m.getY()-l.getY())}var k=cP;D(d,hP);L(d,"geotoolkit.deviation.OutlineTrajectoryStation");d.Vwd=function(l,m,n,p,q){q=new d;q.Uq=l;q.rl=m;if(!q.b8d())return n=q.spa(),{wJb:null,tooShort:n};n=q.spa();q.Ge=q.Ge.concat(p);q.update();return{wJb:q,tooShort:n}};d.prototype.spa=function(){return this.n_};d.prototype.ga=function(){return this.Va};d.prototype.append=
function(l,m,n,p){l=l.clone();m=m.clone();if(n)if(0<this.$e.length&&0<this.Cg.length){var q=N.xf(l,this.$e[this.$e.length-1]);var r=N.xf(m,this.Cg[this.Cg.length-1]);if(1>q&&1>r)return;var t=new N;if(1<this.$e.length&&1<this.Cg.length&&(1<q&&0<a(l,this.$e[this.$e.length-1],this.$e[0],n,t)||1<r&&0<a(m,this.Cg[this.Cg.length-1],this.Cg[0],p,t)))return;if(1<Math.abs(q-r)&&(2<q||2<r)){p=(n=q>r)?k.gG(q):k.gG(r);t=this.$e[this.$e.length-1];var u=this.Cg[this.Cg.length-1],w=N.xf(this.$e[this.$e.length-1],
this.Cg[this.Cg.length-1]);q=(N.xf(l,m)-w)/(n?q:r);r=t.clone();for(var y=u.clone(),z=1;z<p;++z){w+=q;n?r=new N(t.getX()+(l.getX()-t.getX())*z/p,t.getY()+(l.getY()-t.getY())*z/p):y=new N((m.getX()*z+u.getX()*(p-z))/p,(m.getY()*z+u.getY()*(p-z))/p);var x=N.xf(r,y);x<w+1&&(n?r=new N((y.getX()*(x-w)+r.getX()*w)/x,(y.getY()*(x-w)+r.getY()*w)/x):y=new N((r.getX()*(x-w)+y.getX()*w)/x,(r.getY()*(x-w)+y.getY()*w)/x));this.WP.push(N.xf(r,this.$e[this.$e.length-1]));this.j$+=this.WP[this.WP.length-1];this.vT.push(N.xf(y,
this.Cg[this.Cg.length-1]));this.Z$+=this.vT[this.vT.length-1];this.$e.push(r);this.Cg.push(y);this.Va.union(new U(r.getX(),r.getY(),y.getX(),y.getY()))}q=N.xf(l,this.$e[this.$e.length-1]);r=N.xf(m,this.Cg[this.Cg.length-1])}this.WP.push(q);this.j$+=this.WP[this.WP.length-1];this.vT.push(r);this.Z$+=this.vT[this.vT.length-1];this.Va.union(new U(l.getX(),l.getY(),m.getX(),m.getY()))}else this.Va=new U(l.getX(),l.getY(),m.getX(),m.getY());else if(0<this.$e.length&&0<this.Cg.length){q=N.xf(l,this.$e[this.$e.length-
1]);r=N.xf(m,this.Cg[this.Cg.length-1]);if(1>q&&1>r)return;this.WP.push(q);this.j$+=this.WP[this.WP.length-1];this.vT.push(r);this.Z$+=this.vT[this.vT.length-1];0<this.$e.length&&0<this.Cg.length?this.Va.union(new U(l.getX(),l.getY(),m.getX(),m.getY())):this.Va=new U(l.getX(),l.getY(),m.getX(),m.getY())}this.$e.push(l);this.Cg.push(m)};d.prototype.prepend=function(l,m){if(0<this.$e.length&&0<this.Cg.length){var n=N.xf(l,this.$e[0]),p=N.xf(m,this.Cg[0]);if(1>n&&1>p)return;this.WP.unshift(n);this.j$+=
this.WP[0];this.vT.unshift(p);this.Z$+=this.vT[0];0<this.$e.length&&0<this.Cg.length?this.Va.union(new U(l.getX(),l.getY(),m.getX(),m.getY())):this.Va=new U(l.getX(),l.getY(),m.getX(),m.getY())}this.$e.unshift(l);this.Cg.unshift(m)};d.prototype.b8d=function(){var l=iP.a9c(this.Uq,this.rl,this.QUb,this.xi,this.txc,this.sxc,this.n_);this.n_=l.tooShort;this.QUb=l.rZa;if(!l.zVa)return!1;this.Rtb=this.Uq.vg();this.Stb=this.rl.Gf();this.Uq.Ygc(this.txc.getY());this.rl.$gc(this.sxc.getY());this.n_=0;this.pBa(new U(this.Uq.Sf().ka(),
this.Uq.Sf().ma(),this.rl.Sf().na(),this.rl.Sf().la()));return!0};d.prototype.reset=function(){this.Uq.Ygc(this.Rtb);this.rl.$gc(this.Stb)};d.prototype.JY=function(){return(this.j$+this.Z$)/2};d.prototype.BGc=function(l){if(0===this.$e.length||0>=this.Sf().da()||0>=this.Sf().ca())return-1;l=new N(l.getX()-this.Ib.getX(),l.getY()-this.Ib.getY());if(Math.abs(l.getX()-h(this.$e[0],this.Cg[0],l.getY()))<=W.Tb)return 0;for(var m=1;m<this.$e.length;++m)if(this.$e[m-1].getX()===this.$e[m].getX()&&this.$e[m-
1].getY()===this.$e[m].getY()){if(k.VDb(l,this.$e[m],this.Cg[m],this.Cg[m-1]))return m}else if(this.Cg[m-1].getX()===this.Cg[m].getX()&&this.Cg[m-1].getY()===this.Cg[m].getY()){if(k.VDb(l,this.Cg[m],this.$e[m],this.$e[m-1]))return m}else if(k.LTc(l,this.Cg[m-1],this.Cg[m],this.$e[m],this.$e[m-1]))return m;return-1};d.prototype.contains=function(l,m,n){if(l instanceof N)return 0<=this.BGc(l);var p=new N,q=new N;l=new U(l.kd().getX()-this.Ib.getX(),l.kd().getY()-this.Ib.getY(),l.yf().getX()-this.Ib.getX(),
l.yf().getY()-this.Ib.getY());for(var r=!1,t=!1,u=0,w=this.$e.length-1,y=u,z=w;(!1===r||!1===t)&&u<w;){if(!r){if(t&&(z>w&&(z=w),u>=z)){u>z&&(u=z);r=!0;break}if(0<=l.Gaa(this.$e[u],this.Cg[u],p,q))u-1<=y?r=!0:(z=u,u=k.gG((u+y)/2));else if(t)if(u+1>=z){u=z;r=!0;break}else y=u,u=k.gG((u+z)/2);else u++}if(!t){if(r&&(y<u&&(y=u),w<=y)){w<y&&(w=y);t=!0;break}if(0<=l.Gaa(this.$e[w],this.Cg[w],p,q))w+1>=z?t=!0:(y=w,w=k.gG((w+z)/2));else if(r)if(w-1<=y){w=y;t=!0;break}else z=w,w=k.gG((w+y)/2);else w--}}if(!r&&
!t)return{Zf:m,Yf:n,contain:!1};r&&(0<u&&u--,m>this.Bs[u]&&(m=this.Bs[u]));t&&(w<this.Bs.length-1&&w++,n<this.Bs[w]&&(n=this.Bs[w]));return{Zf:m,Yf:n,contain:!0}};d.prototype.update=function(){hP.prototype.update.call(this);this.WP=[];this.vT=[];this.Z$=this.j$=0;if(!(0>this.n_)){var l=[],m;if(this.QUb){var n=k.d2b(this.Uq.yf(),this.xi,this.rl.fg());0===this.n_&&e(l,this.xi,this.Uq.fg(),this.Uq.yf(),this.rl.fg(),this.rl.yf(),this.Uq.transform(new N(this.Sf().na(),this.Rtb)),n);for(m=0;m<this.Ge.length;++m)e(l,
this.xi,this.Uq.fg(),this.Uq.yf(),this.rl.fg(),this.rl.yf(),this.Ge[m].fg(),n),e(l,this.xi,this.Uq.fg(),this.Uq.yf(),this.rl.fg(),this.rl.yf(),this.Ge[m].yf(),n);0===this.n_&&e(l,this.xi,this.Uq.fg(),this.Uq.yf(),this.rl.fg(),this.rl.yf(),this.rl.transform(new N(this.Sf().na(),this.Stb)),n);l.sort(c);this.append(this.xi,this.Uq.yf());if(0===l.length)this.append(this.xi,this.rl.fg(),this.xi,this.rl.fg());else{this.append(this.xi,l[0].point);for(n=1;n<l.length;n++)this.append(this.xi,l[n].point,this.xi,
this.rl.fg());this.append(this.xi,this.rl.fg())}}else{n=k.d2b(this.Uq.dg(),this.xi,this.rl.kd());0===this.n_&&e(l,this.xi,this.Uq.kd(),this.Uq.dg(),this.rl.kd(),this.rl.dg(),this.Uq.transform(new N(this.Sf().ka(),this.Rtb)),n);for(m=0;m<this.Ge.length;++m)e(l,this.xi,this.Uq.kd(),this.Uq.dg(),this.rl.kd(),this.rl.dg(),this.Ge[m].kd(),n),e(l,this.xi,this.Uq.kd(),this.Uq.dg(),this.rl.kd(),this.rl.dg(),this.Ge[m].dg(),n);0===this.n_&&e(l,this.xi,this.Uq.kd(),this.Uq.dg(),this.rl.kd(),this.rl.dg(),this.rl.transform(new N(this.Sf().ka(),
this.Stb)),n);l.sort(c);this.append(this.Uq.dg(),this.xi);if(0===l.length)this.append(this.rl.kd(),this.xi,this.rl.kd(),this.xi);else{this.append(l[0].point,this.xi);for(n=1;n<l.length;n++)this.append(l[n].point,this.xi,this.rl.kd(),this.xi);this.append(this.rl.kd(),this.xi)}}}};d.prototype.r$c=function(){if(!(0>this.n_||(this.pBa(new U(this.Uq.Sf().ka(),this.Uq.Sf().ma(),this.rl.Sf().na(),this.rl.Sf().la())),this.Bs=[],1>=this.$e.length||(this.Rgc(new N(this.$e[0].getX()+this.Ib.getX(),this.$e[0].getY()+
this.Ib.getY())),this.Mhc(new N(this.Cg[0].getX()+this.Ib.getX(),this.Cg[0].getY()+this.Ib.getY())),this.Ihc(new N(this.Cg[this.Cg.length-1].getX()+this.Ib.getX(),this.Cg[this.Cg.length-1].getY()+this.Ib.getY())),this.Ogc(new N(this.$e[this.$e.length-1].getX()+this.Ib.getX(),this.$e[this.$e.length-1].getY()+this.Ib.getY())),0>=this.Sf().da()||0>=this.Sf().ca())))){var l=this.Sf().la();this.Bs.push(l);for(var m=0;m<this.WP.length-1;++m){var n=(this.WP[m]+this.vT[m])/(this.j$+this.Z$);l+=n*this.Sf().da();
if(l>this.Sf().ma())break;this.Bs.push(l)}this.Bs.push(this.Sf().ma())}};d.prototype.Ocb=function(l){if(0>=this.Sf().da()||1>=this.Bs.length)return-1;var m=0,n=this.Bs.length-1;if(l.getY()<=this.Bs[0])return 0;if(l.getY()>=this.Bs[n])return n;for(var p;1<n-m;){var q=m+n>>1;p=this.Bs[q]-l.getY();if(Math.abs(p)<=W.Tb)return q;0>p?m=q:n=q}return n};d.prototype.transform=function(l,m){if(null==m){if(l.getY()>=this.Sf().la()&&l.getY()<=this.Sf().ma()){var n=new N;m=this.Sf();var p=(l.getX()-m.ka())/m.ca();
if(Math.abs(l.getY()-m.la())<=W.Tb)n.setX(this.$e[0].getX()+(this.Cg[0].getX()-this.$e[0].getX())*p),n.setY(this.$e[0].getY()+(this.Cg[0].getY()-this.$e[0].getY())*p);else if(Math.abs(l.getY()-m.ma())<=W.Tb)n.setX(this.$e[this.$e.length-1].getX()+(this.Cg[this.Cg.length-1].getX()-this.$e[this.$e.length-1].getX())*p),n.setY(this.$e[this.$e.length-1].getY()+(this.Cg[this.Cg.length-1].getY()-this.$e[this.$e.length-1].getY())*p);else if(m=this.Ocb(l),0<m&&m<this.$e.length){var q=(l.getY()-this.Bs[m-1])/
(this.Bs[m]-this.Bs[m-1]);l=new N(this.$e[m-1].getX()+(this.$e[m].getX()-this.$e[m-1].getX())*q,this.$e[m-1].getY()+(this.$e[m].getY()-this.$e[m-1].getY())*q);m=new N(this.Cg[m-1].getX()+(this.Cg[m].getX()-this.Cg[m-1].getX())*q,this.Cg[m-1].getY()+(this.Cg[m].getY()-this.Cg[m-1].getY())*q);n.setX(l.getX()+(m.getX()-l.getX())*p);n.setY(l.getY()+(m.getY()-l.getY())*p)}else n.setX(this.$e[0].getX()+(this.Cg[0].getX()-this.$e[0].getX())*p),n.setY(this.$e[0].getY()+(this.Cg[0].getY()-this.$e[0].getY())*
p);return new N(n.getX()+this.Ib.getX(),n.getY()+this.Ib.getY())}return l}if(0>=this.Sf().da()||1>=this.Bs.length)return l;p=(l.getX()-this.Sf().ka())/this.Sf().ca();n=new N;Math.abs(this.Bs[m]-l.getY())<=W.Tb||0>=m?(n.setX(this.$e[m].getX()+(this.Cg[m].getX()-this.$e[m].getX())*p),n.setY(this.$e[m].getY()+(this.Cg[m].getY()-this.$e[m].getY())*p)):(q=(l.getY()-this.Bs[m-1])/(this.Bs[m]-this.Bs[m-1]),l=new N(this.$e[m-1].getX()+(this.$e[m].getX()-this.$e[m-1].getX())*q,this.$e[m-1].getY()+(this.$e[m].getY()-
this.$e[m-1].getY())*q),m=new N(this.Cg[m-1].getX()+(this.Cg[m].getX()-this.Cg[m-1].getX())*q,this.Cg[m-1].getY()+(this.Cg[m].getY()-this.Cg[m-1].getY())*q),n.setX(l.getX()+(m.getX()-l.getX())*p),n.setY(l.getY()+(m.getY()-l.getY())*p));return new N(n.getX()+this.Ib.getX(),n.getY()+this.Ib.getY())};d.prototype.tG=function(l,m,n,p,q){if(!(0>=this.Sf().da()||this.Sf().la()>=m.getY()||this.Sf().ma()<=l.getY()||1>=this.Bs.length)){var r=this.Ocb(l),t=this.Ocb(m);0===r?(k.Ar(p,this.transform(g(l,m,this.Bs[0]),
0),n,q),++r):k.Ar(p,this.transform(l,r),n,q);for(;r<t;++r){var u=g(l,m,this.Bs[r]);k.Ar(p,this.transform(u,r),n,q)}this.Bs[t]<m.getY()?k.Ar(p,this.transform(g(l,m,this.Bs[t]),t),n,q):k.Ar(p,this.transform(m,t),n,q)}};d.prototype.RBa=function(l,m,n,p,q){if(!(0>=this.Sf().da()||this.Sf().la()>=l.getY()||this.Sf().ma()<=m.getY()||1>=this.Bs.length)){var r=this.Ocb(l),t=this.Ocb(m);for(this.Bs[r]<l.getY()?k.Ar(p,this.transform(g(l,m,this.Bs[r]),r),n,q):k.Ar(p,this.transform(l,r),n,q);r>t;--r){var u=g(l,
m,this.Bs[r-1]);k.Ar(p,this.transform(u,r-1),n,q)}0<t&&k.Ar(p,this.transform(m,t),n,q)}};d.prototype.sc=function(l){if(0>=this.Sf().da()||1>=this.Bs.length)return new N(l.getX()-this.Ib.getX(),l.getY()-this.Ib.getY());var m=this.BGc(l);if(0>m)return new N(l.getX()-this.Ib.getX(),l.getY()-this.Ib.getY());var n=this.Sf(),p=n.kd();l=new N(l.getX()-this.Ib.getX(),l.getY()-this.Ib.getY());if(0===m)p.setX(p.getX()+n.ca()*N.xf(this.$e[0],l)/N.xf(this.$e[0],this.Cg[0]));else{p.setY(this.Bs[m-1]);var q=this.Bs[m]-
this.Bs[m-1],r=new N;if(this.$e[m-1].getX()===this.$e[m].getX()&&this.$e[m-1].getY()===this.$e[m].getY())k.Koa(this.$e[m],l,this.Cg[m-1],this.Cg[m],r)&&(p.setY(p.getY()+q*N.xf(r,this.Cg[m-1])/this.vT[m-1]),p.setX(p.getX()+n.ca()*N.xf(l,this.$e[m])/N.xf(r,this.$e[m])));else if(this.Cg[m-1].getX()===this.Cg[m].getX()&&this.Cg[m-1].getY()===this.Cg[m].getY())k.Koa(this.Cg[m],l,this.$e[m-1],this.$e[m],r)&&(p.setY(p.getY()+q*N.xf(r,this.$e[m-1])/this.WP[m-1]),p.setX(p.getX()+n.ca()*N.xf(l,r)/N.xf(r,this.Cg[m])));
else{var t=new N,u=new N;k.Koa(this.$e[m-1],this.Cg[m-1],this.$e[m],this.Cg[m],r)||r.Da(l.getX()-this.Cg[m-1].getX()+this.$e[m-1].getX(),l.getY()-this.Cg[m-1].getY()+this.$e[m-1].getY());k.Koa(r,l,this.$e[m-1],this.$e[m],t)&&k.Koa(r,l,this.Cg[m-1],this.Cg[m],u)&&(p.setY(p.getY()+q*(N.xf(t,this.$e[m-1])/this.WP[m-1]+N.xf(u,this.Cg[m-1])/this.vT[m-1])/2),p.setX(p.getX()+n.ca()*N.xf(l,t)/N.xf(u,t)))}}return p};d.prototype.kZ=function(l){var m=l.clone();m.setX(m.getX()+1);return Math.abs(this.sc(m).getX()-
this.sc(l).getX())};d.prototype.lZ=function(l){var m=l.clone();m.setY(m.getY()+1);return Math.abs(this.sc(m).getY()-this.sc(l).getY())};d.prototype.offset=function(l){this.Ib.Da(this.Ib.getX()+l.getX(),this.Ib.getY()+l.getY());hP.prototype.offset.call(this,l)};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJ0cmFuc2Zvcm1MaW5lIjoidEciLCJ0cmFuc2Zvcm1MaW5lUmV2IjoiUkJhIiwiaW52ZXJzZVRyYW5zZm9ybSI6InNjIiwic2NhbGVYQXQiOiJrWiIsInNjYWxlWUF0IjoibFoifX19");var kP=/*#__PURE__*/function(){function d(b){this.sZb=b}function a(b,c,e){this.mu=b;this.$hb=c;this.Qza=void 0!==e?e:-1}L(d,"geotoolkit.deviation.PiecewiseApproximator");d.prototype.u1b=function(b,c){var e=[];e.push(new a(b,this.sZb.transform(b),1));e.push(new a(c,this.sZb.transform(c),-1));for(b=0;-1!==e[b].Qza;){c=e[b];var f=e[c.Qza],g=N.xf(c.$hb,f.$hb);if(1>g)b=c.Qza;else{var h=new N((c.mu.getX()+f.mu.getX())/2,(c.mu.getY()+f.mu.getY())/2),k=this.sZb.transform(h),l=c.Qza;f=new eP(c.$hb,f.$hb);g=f.distance(k);
.5>Math.abs(g)?b=c.Qza:(c.Qza=e.length,e.push(new a(h,k,l)))}}return e};return d}();var lP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){hP.call(this,new U,!0);this.AP=this.ODa=this.KYb=this.Fpb=this.Fc=this.goa=this.foa=this.ISa=this.mTa=this.xi=this.Ctb=this.vub=null;this.Gkd=new kP(this);this.kg=this.N4=null;this.Fi=NaN;this.Va=null}var a=cP,b=eP;L(d,"geotoolkit.deviation.PieSliceTrajectoryStation");D(d,hP);d.prototype.JY=function(){return this.Fi};d.prototype.ga=function(){return this.Va};d.Ywd=function(c,e,f){var g=new N,h=new N,k=new N,l=iP.a9c(c,e,m,g,h,k,f);var m=l.rZa;f=l.tooShort;if(!l.zVa)return{wJb:null,
tooShort:f};c.Ygc(h.getY());e.$gc(k.getY());h=m?c.yf():c.dg();k=new N(h.getX()-g.getX(),h.getY()-g.getY());h=m?e.fg():e.kd();h=new N(h.getX()-g.getX(),h.getY()-g.getY());l=Math.atan2(k.getY(),k.getX());var n=X.Ui(-l,0,0),p=X.jf(-g.getX(),-g.getY());p=X.multiply(n,p);n=n.Ma(h);h=new d;h.ODa=Math.atan2(n.getY(),n.getX());h.Fpb=p;h.KYb=p.xc();m?(h.foa=c.Sf().ka(),h.goa=c.Sf().na()-h.foa):(h.foa=c.Sf().na(),h.goa=c.Sf().ka()-h.foa);h.xi=g;h.Fc=N.xf(k,new N(0,0));h.AP=l;h.Rgc(c.dg());h.Mhc(c.yf());h.Ogc(e.kd());
h.Ihc(e.fg());h.Fi=Math.abs(h.Fc*h.ODa/2);h.pBa(new U(c.Sf().dg().getX(),c.Sf().dg().getY(),e.Sf().fg().getX(),e.Sf().fg().getY()));k=new b(g,m?c.yf():c.dg());l=new b(g,m?e.fg():e.kd());0<k.distance(m?e.fg():e.kd())?(h.vub=k,h.Ctb=l,m?(m=c.yf(),k=e.fg()):(m=c.dg(),k=e.kd())):(h.vub=l,h.Ctb=k,m?(k=c.yf(),m=e.fg()):(k=c.dg(),m=e.kd()));h.mTa=new N(m.getX(),m.getY());h.ISa=new N(k.getX(),k.getY());h.Va=new U(c.dg().getX(),c.dg().getY(),c.yf().getX(),c.yf().getY());h.Va.union(new U(e.kd().getX(),e.kd().getY(),
e.fg().getX(),e.fg().getY()));c=new N(g.getX()-h.Fc,g.getY());h.contains(c)&&h.Va.ka()>c.getX()&&h.Va.setX(c.getX());c=new N(g.getX()+h.Fc,g.getY());h.contains(c)&&h.Va.na()<c.getX()&&h.Va.Qa(c.getX()-h.Va.ka());c=new N(g.getX(),g.getY()-h.Fc);h.contains(c)&&h.Va.la()>c.getY()&&h.Va.setY(c.getY());g=new N(g.getX(),g.getY()+h.Fc);h.contains(g)&&h.Va.ma()<g.getY()&&h.Va.$a(g.getY()-h.Va.la());return{wJb:h,tooShort:f}};d.prototype.update=function(c,e){this.pBa(new U(c.Sf().ka(),c.vg(),c.Sf().na(),e.Gf()))};
d.prototype.offset=function(c){hP.prototype.offset.call(this,c);var e=c.getX();c=c.getY();this.xi.Da(this.xi.getX()+e,this.xi.getY()+c);this.mTa.Da(this.mTa.getX()+e,this.mTa.getY()+c);this.ISa.Da(this.ISa.getX()+e,this.ISa.getY()+c);e=X.Ui(-this.AP,0,0);c=X.jf(-this.xi.getX(),-this.xi.getY());this.Fpb=X.multiply(e,c);this.KYb=this.Fpb.xc();this.vub.Cr(this.xi,this.mTa);this.Ctb.Cr(this.xi,this.ISa)};d.prototype.contains=function(c,e,f){if(c instanceof N)return N.xf(this.xi,c)-this.Fc<W.Tb&&0<this.vub.distance(c)&&
0>this.Ctb.distance(c);var g=this.Sf();if(c.contains(this.xi)||c.contains(this.mTa)&&c.contains(this.ISa))return e>g.la()&&(e=g.la()),f<g.ma()&&(f=g.ma()),{Zf:e,Yf:f,contain:!0};g=this.xi.clone();this.xi.getY()<c.la()?g.setY(c.la()):this.xi.getY()>c.ma()&&g.setY(c.ma());this.xi.getX()<c.ka()?g.setX(c.ka()):this.xi.getX()>c.na()&&g.setX(c.na());if(N.xf(this.xi,g)>this.Fc)return{Zf:e,Yf:f,contain:!1};var h=hP.prototype.contains.call(this,c,e,f);e=h.Zf;f=h.Yf;if(h.contain)return{Zf:e,Yf:f,contain:!0};
if(!this.contains(g))return{Zf:e,Yf:f,contain:!1};f=this.vFc(c.ka(),c,e,f);f=this.vFc(c.na(),c,f.Zf,f.Yf);f=this.xFc(c.la(),c,f.Zf,f.Yf);f=this.xFc(c.ma(),c,f.Zf,f.Yf);e=f.Zf;f=f.Yf;return{Zf:e,Yf:f,contain:!0}};d.prototype.sc=function(c){var e=c.getX(),f=c.getY();Math.abs(this.Fc)>W.Tb&&(e=this.foa+this.goa*(N.xf(c,this.xi)/this.Fc));c=this.Fpb.Ma(c);Math.abs(this.ODa)>W.Tb&&(f=this.Sf().la()+Math.atan2(c.getY(),c.getX())/this.ODa*this.Sf().da());return new N(e,f)};d.prototype.transform=function(c){var e=
Math.abs(this.goa)>W.Tb?(c.getX()-this.foa)/this.goa:c.getX()-this.foa;c=this.Sf().da()>W.Tb?(c.getY()-this.Sf().la())/this.Sf().da():c.getY()-this.Sf().la();c=X.Ui(this.ODa*c,0,0);e=new N(this.Fc*e,0);return this.KYb.Ma(c.Ma(e))};d.prototype.kZ=function(c){return Math.abs(this.goa)>W.Tb?Math.abs(this.Fc/this.goa):Math.abs(this.Fc)};d.prototype.lZ=function(c){c=Math.abs(this.goa)>W.Tb?(c.getX()-this.foa)/this.goa:c.getX()-this.foa;return this.Sf().da()>W.Tb?Math.abs(this.ODa*this.Fc*c/this.Sf().da()):
Math.abs(this.ODa*this.Fc*c)};d.prototype.tG=function(c,e,f,g,h){if(cP.kZc(c.getY(),e.getY()))this.gUc(c,e,f,g,h);else{this.N4=!0;var k=this.Sf();k.la()<=c.getY()&&k.ma()>=c.getY()&&this.process(g,c,f,h);k.la()>c.getY()&&k.la()<e.getY()&&this.process(g,a.GR(c,e,k.la()),f,h);k.ma()>c.getY()&&k.ma()<e.getY()&&this.process(g,a.GR(c,e,k.ma()),f,h);k.la()<=e.getY()&&k.ma()>=e.getY()&&this.process(g,e,f,h)}};d.prototype.RBa=function(c,e,f,g,h){if(cP.kZc(c.getY(),e.getY()))this.gUc(c,e,f,g,h);else{this.N4=
!0;var k=this.Sf();k.la()<=c.getY()&&k.ma()>=c.getY()&&this.process(g,c,f,h);k.ma()>e.getY()&&k.ma()<c.getY()&&this.process(g,a.GR(c,e,k.ma()),f,h);k.la()>e.getY()&&k.la()<c.getY()&&this.process(g,a.GR(c,e,k.la()),f,h);k.la()<=e.getY()&&k.ma()>=e.getY()&&this.process(g,e,f,h)}};d.prototype.process=function(c,e,f,g){if(this.N4)a.Ar(c,this.transform(e),f,g),this.kg=e&&e.clone(),this.N4=!1;else{e=this.Gkd.u1b(this.kg,e);var h=0;do h=e[h].Qza,a.Ar(c,e[h].$hb,f,g);while(-1!==e[h].Qza)}};d.prototype.gUc=
function(c,e,f,g,h){a.Ar(g,this.transform(c),f,h);a.Ar(g,this.transform(e),f,h)};d.prototype.vFc=function(c,e,f,g){var h=new N,k=Math.abs(c-this.xi.getX());k<=this.Fc&&(h.setX(c),k=Math.sqrt(this.Fc*this.Fc-k*k),this.xi.getY()-k<e.la()?h.setY(e.la()):h.setY(this.xi.getY()-k),this.contains(h)&&(h=this.sc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())),h.setX(c),this.xi.getY()+k>e.ma()?h.setY(e.ma()):h.setY(this.xi.getY()+k),this.contains(h)&&(h=this.sc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&
(g=h.getY())));return{Zf:f,Yf:g}};d.prototype.xFc=function(c,e,f,g){var h=new N,k=Math.abs(c-this.xi.getY());k<=this.Fc&&(h.setY(c),k=Math.sqrt(this.Fc*this.Fc-k*k),this.xi.getX()-k<e.ka()?h.setX(e.ka()):h.setX(this.xi.getX()-k),this.contains(h)&&(h=this.sc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())),h.setY(c),this.xi.getX()+k>e.na()?h.setX(e.na()):h.setX(this.xi.getX()+k),this.contains(h)&&(h=this.sc(h),f>h.getY()&&(f=h.getY()),g<h.getY()&&(g=h.getY())));return{Zf:f,Yf:g}};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZlcnNlVHJhbnNmb3JtIjoic2MiLCJzY2FsZVhBdCI6ImtaIiwic2NhbGVZQXQiOiJsWiIsInRyYW5zZm9ybUxpbmUiOiJ0RyIsInRyYW5zZm9ybUxpbmVSZXYiOiJSQmEifX19");var mP=/*#__PURE__*/function(){function d(a,b){this.zsa=void 0!==a?a:-1;this.i8=b||new U;this.yNa=Number.MAX_VALUE}L(d,"geotoolkit.deviation.StationBounds");return d}();var nP=/*#__PURE__*/function(){function d(a,b){this.Wmb=a;this.tw=b}L(d,"geotoolkit.deviation.StationPair");return d}();var oP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(g,h,k){$O.call(this);g=G(g,{filter:!0,trackWidth:0,offset:0});this.Aq=g.trajectory;this.Cf=g.filter;this.zx=g.trackWidth;this.Ib=g.offset;k=k?k.clone():new X;this.ja=new a(k);this.Ce=k;this.awc=h.joinSegments;this.QPb=h.approxThreshold;this.hsc=void 0!==h.approxThresholdMd?h.approxThresholdMd:this.QPb;this.y_b=h.trackWidthStrategy;null==this.y_b&&(this.y_b=new bP({scaleWidth:h.scaleWidth,minWidth:h.minWidth,maxWidth:h.maxWidth,widthScaleX:h.widthScaleX,widthScaleY:h.widthScaleY}));
this.aTa=h.outlineSegments;this.$yc=h.outlineModelBboxAdjust;this.CF=-1;this.jEa=[];this.$K=new X;this.YIe=new X;this.DN=new N;this.Va=null;this.HK=[new N,new N];this.tra();this.D0c()}function a(g){this.Ce=g;this.Ge=[];this.iH=new ZO;this.SW=this.vsc=this.tSa=this.sSa=this.Lfa=this.Kfa=this.iT=this.hT=1}function b(g,h){return Math.abs(h)>Math.abs(g)?0>h?-Math.atan(g/h):Math.PI-Math.atan(g/h):0>g?-Math.PI/2+Math.atan(h/g):Math.PI/2+Math.atan(h/g)}function c(g,h){return g.xx===h.xx&&g.yy===h.yy}function e(g){var h=
W.NO(g.lb(),5);g=W.NO(g.Ab(),5);return{xx:h,yy:g}}var f=16;D(d,$O);L(d,"geotoolkit.deviation.PiecewiseTransformation");d.prototype.a8d=function(){this.ja.vsc=1;var g=this.ja.Ge.length;if(g){var h=this.ja.Ge[0];g=this.ja.Ge[g-1];h=h.Gf();g=g.vg();var k=[new N(0,h),new N(0,g)],l=[];this.bK(k,l,this.Ce);for(var m=k=0;m<l.length-1;++m)k+=N.xf(l[m],l[m+1]);k&&(this.ja.vsc=Math.max(1,2*cP.gG(.5+k/Math.abs(g-h))))}};d.prototype.Q1=function(g){var h=this.ja.Ge.length,k=W.findIndex(null,this.ja.Ge,null,null,
function(l){l=l.Sf().ma()-g;return Math.abs(l)>W.Tb?l:0});0>k?k=~k:++k;k>=h&&(k=h-1);return k};d.prototype.transform=function(g,h){h&&(g=h.Ma(g));h=this.Q1(g.getY());for(0>h&&(h=0);h<this.ja.Ge.length;++h){var k=this.ja.Ge[h].Sf();if(g.getY()<=k.ma()&&g.getY()>=k.la()||k.ma()>g.getY())return this.ja.Ge[h].transform(g)}return 0<this.ja.Ge.length?this.ja.Ge[this.ja.Ge.length-1].transform(g):new N};d.prototype.sc=function(g){if(0<=this.CF&&this.CF<this.ja.Ge.length){for(var h=0;this.CF+h<this.ja.Ge.length||
0<=this.CF-h;){if(this.CF+h<this.ja.Ge.length&&this.ja.Ge[this.CF+h].contains(g))return this.CF+=h,this.ja.Ge[this.CF].sc(g);if(0<=this.CF-h&&this.ja.Ge[this.CF-h].contains(g))return this.CF-=h,this.ja.Ge[this.CF].sc(g);h++}return new N(Number.NaN,Number.NaN)}h=this.ja.iH.aqa();for(var k=this.ja.iH.wZa(g.getY()-this.Ce.Pe());k<h.length;++k){var l=h[k];this.DN.Da(NaN,NaN);if(this.ja.Ge[l.tw.zsa].contains(g,this.DN))return this.CF=l.tw.zsa,W.Hq(this.DN.getX())&&W.Hq(this.DN.getY())?this.DN:this.ja.Ge[this.CF].sc(g);
if(g.getY()<l.tw.yNa)break}return new N(Number.NaN,Number.NaN)};d.prototype.tG=function(g,h,k,l){0!==this.ja.Ge.length&&this.bK([g,h],k,l)};d.prototype.bK=function(g,h,k,l){var m=g.length;if(1<m&&0<this.ja.Ge.length){(l=l&&!cP.KYc(g,m))&&++m;if(k){var n=k.lb();var p=k.Ab();var q=k.cf();k=k.Pe()}else p=n=1,k=q=0;for(var r=new N(Number.MAX_VALUE,Number.MAX_VALUE),t=new N(g[0].getX()*n+q,g[0].getY()*p+k),u=new N,w=0,y=1,z=0;z<m-1;++z,++y){l&&z===m-2&&(y=0);u.Da(g[y].getX()*n+q,g[y].getY()*p+k);if(0>
w||w>=this.ja.Ge.length||!(this.ja.Ge[w].Sf().la()<=t.getY()&&this.ja.Ge[w].Sf().ma()>=t.getY()))w=this.Q1(t.getY());var x;if(t.getY()<=u.getY())for(x=w;x<this.ja.Ge.length;++x){var C=this.ja.Ge[x];var A=C.Sf();C.tG(t,u,r,h,this.Cf);if(A.ma()>=u.getY()){w=x;break}}else for(w>=this.ja.Ge.length&&(w=this.ja.Ge.length-1),x=w;0<=x;--x)if(C=this.ja.Ge[x],A=C.Sf(),C.RBa(t,u,r,h,!1),A.la()<=u.getY()){w=x;break}t.Da(u.getX(),u.getY())}}};d.prototype.contains=function(g){for(var h=this.ja.iH.aqa(),k=this.ja.iH.wZa(g.getY()-
this.Ce.Pe());k<h.length;++k){var l=h[k];if(l.tw.i8.contains(g)&&this.ja.Ge[l.tw.zsa].contains(g))return!0;if(g.getY()<l.tw.yNa)break}return!1};d.prototype.iya=function(g){var h=this.Aq.WOc(this.Ce,this.QPb,this.hsc),k=h.IRb;h=[];this.HK[0].Da(g.ka(),g.la());this.HK[1].Da(g.na(),g.la());var l=dP.PKa(this.HK,k);l&&h.push(l);this.HK[0].Da(g.ka(),g.ma());this.HK[1].Da(g.na(),g.ma());(l=dP.PKa(this.HK,k))&&h.push(l);this.HK[0].Da(g.ka(),g.la());this.HK[1].Da(g.ka(),g.ma());(l=dP.PKa(this.HK,k))&&h.push(l);
this.HK[0].Da(g.na(),g.la());this.HK[1].Da(g.na(),g.ma());(l=dP.PKa(this.HK,k))&&h.push(l);return 2===h.length?(g=this.sc(h[0]),h=this.sc(h[1]),isNaN(g.getX())||isNaN(g.getY())||isNaN(h.getX())||isNaN(h.getY())?null:[new Kd(g.getY(),h.getY())]):0!==h.length||g.contains(k[0])?null:[]};d.prototype.zWa=function(g){if(1>this.ja.Ge.length)return Si.kn();g=this.Ce.Ua(g);var h=Infinity,k=-Infinity,l=this.ja.iH.aqa();var m=this.ja.iH.c9d(g.ma()-this.Ce.Pe());0<m&&m--;if(m!==l.length-1&&g.Dd(l[m].tw.i8)){var n=
this.ja.Ge[l[m].tw.zsa];var p=n.Sf();0<=g.Gaa(n.kd(),n.fg(),this.DN,this.DN)&&(h=p.la());0<=g.Gaa(n.dg(),n.yf(),this.DN,this.DN)&&(k=p.ma())}for(m=this.ja.iH.wZa(g.la()-this.Ce.Pe());m<l.length;++m){var q=l[m];n=this.ja.Ge[q.tw.zsa];p=n.Sf();if(h>p.la()||k<p.ma())p=new U(g),p.intersect(q.tw.i8),p.isEmpty()||(k=n.contains(p,h,k),h=k.Zf,k=k.Yf);if(q.tw.yNa>g.ma())break}return h>k?Si.kn():new U(0,h,this.zx,k)};d.prototype.update=function(g){this.Va=null;var h=e(g),k=e(this.Ce);if(c(h,k))return this.shift(g),
!0;var l=null;this.jEa.some(function(m){return c(m.key,h)?(l=m.value,!0):!1});l?(this.ja=l,this.Ce=this.ja.Ce,this.ja.SW<Number.MAX_VALUE-1&&this.ja.SW++,this.shift(g)):(this.ja=new a(g),this.Ce=g,this.D0c(),this.tra());return!0};d.prototype.kZ=function(g){var h=this.Q1(g.getY());for(0>h&&(h=0);h<this.ja.Ge.length;++h){var k=this.ja.Ge[h].Sf();if(g.getY()<=k.ma()&&g.getY()>=k.la())return this.ja.Ge[h].kZ(g);if(k.ma()>g.getY())break}return this.ja.hT};d.prototype.lZ=function(g){var h=this.Q1(g.getY());
for(0>h&&(h=0);h<this.ja.Ge.length;++h){var k=this.ja.Ge[h].Sf();if(g.getY()<=k.ma()&&g.getY()>=k.la())return this.ja.Ge[h].lZ(g);if(k.ma()>g.getY())break}return this.ja.iT};d.prototype.QY=function(){return this.ja.hT};d.prototype.RY=function(){return this.ja.iT};d.prototype.WU=function(){return this.ja.Kfa};d.prototype.XU=function(){return this.ja.Lfa};d.prototype.REb=function(){return this.ja.sSa};d.prototype.SEb=function(){return this.ja.tSa};d.prototype.Maa=function(g,h){if(this.ja.Ge[this.CF]&&
this.ja.Ge[this.CF].contains(g))return this.ja.Ge[this.CF].Maa(g,h);for(var k=this.ja.iH.aqa(),l=this.ja.iH.wZa(g.getY()-this.Ce.Pe());l<k.length;++l){var m=k[l];if(m.tw.i8.contains(g))return this.CF=m.tw.zsa,this.ja.Ge[this.CF].Maa(g,h);if(g.getY()<m.tw.yNa)break}return null};d.prototype.VJe=function(){this.jEa.forEach(function(g){delete g.value})};d.prototype.tra=function(){var g=!1;this.ja.hT=0;this.ja.iT=0;this.ja.Kfa=0;this.ja.Lfa=0;this.ja.sSa=1;this.ja.tSa=1;for(var h=[],k=[],l=[],m=this.y_b.ca(this.Ce,
{width:this.zx,trajectory:this.Aq})/this.zx,n=this.Aq.WOc(this.Ce,this.QPb,this.hsc),p=this.Ce.xc(),q,r,t,u,w,y=[],z=[],x,C,A=new X;!n.end();)if(null==q&&(w=n.object(),q=0===h.length?w.qtd():r,t=0===h.length?w.line().project(this.Ce.Pc(this.Aq.getX(q),this.Aq.getY(q))):u,r=w.q4b(),u=w.line().project(this.Ce.Pc(this.Aq.getX(r),this.Aq.getY(r))),w=p.Ma(t),C=t.getY()-u.getY(),x=t.getX()-u.getX(),x=b(x,C),X.jf(w.getX(),w.getY(),this.$K),X.multiply(this.Ce,this.$K,A),this.Ce.Ma(w,this.DN),X.Ui(x,this.DN.getX(),
this.DN.getY(),this.$K),X.multiply(this.$K,A,A),x=0===A.Ii()?Math.abs(A.lb()):Math.sqrt(A.lb()*A.lb()+A.vi()*A.vi()),C=0===A.vi()?Math.abs(A.Ab()):Math.sqrt(A.Ab()*A.Ab()+A.Ii()*A.Ii()),0>this.Ce.Ab()&&(C=-C),0>this.Ce.lb()&&(x=-x),t=N.xf(t,u),w=this.Aq.Ub(r)-this.Aq.Ub(q),C=Math.abs(w)>W.Tb?1/C*(t/w):1,this.$K.Sb(m/x,0,0,C,0,0),X.multiply(A,this.$K,A),this.$K.Sb(1,0,0,1,-this.zx/2+this.Ib,-this.Aq.Ub(q)),X.multiply(A,this.$K,A),q=new U(0,this.Aq.Ub(q),this.zx,this.Aq.Ub(r)),q=new iP(A,q,!1),q.update()),
this.awc){var v=0;if(0===y.length)h.push(t),k.push(this.Aq.Ub(0)+w),l.push(q.JY()),q.ezb(),y.push(q),q=null,n.next();else{var B=y[y.length-1];l[l.length-1]-=B.JY();v=this.aTa?jP.Vwd(B,q,v,z,this.$yc):lP.Ywd(B,q,v);var E=v.wJb;v=v.tooShort;l[l.length-1]+=B.JY();0<=v&&(h.push(h[h.length-1]+t),k.push(k[k.length-1]+w));E?(z=[],y.push(E),l.push(E.JY()+l[l.length-1])):-2===v?1<h.length?(h[h.length-2]=h[h.length-1],k[k.length-2]=k[k.length-1],h.pop(),k.pop(),l.pop(),y.pop(),this.aTa?(z.unshift(B),B=y[y.length-
1],B instanceof jP&&(l.pop(),y.pop(),l[l.length-1]-=y[y.length-1].JY(),B.reset(),l[l.length-1]+=y[y.length-1].JY(),B.Ge=B.Ge.concat(z),z=B.Ge.slice())):y[y.length-1]instanceof lP&&(l.pop(),y.pop())):(h[h.length-1]+=t,k[k.length-1]+=w,l[l.length-1]-=B.JY(),B.Sb(q.Ea()),q=B.Sf().clone().union(q.Sf()),B.pBa(q),B.update(),l[l.length-1]+=B.JY(),q=null,v=0,n.next(),this.aTa&&(z=[])):0===v?(B.ezb(),q.ezb()):(h[h.length-1]+=t,k[k.length-1]+=w,n.next(),n.end()&&(l[l.length-1]-=B.JY(),B.pBa(B.Sf().clone().union(q.Sf())),
B.update(),l[l.length-1]+=B.JY()),this.aTa&&z.push(q),q=null)}q&&0<=v&&(y.push(q),l.push(q.JY()+l[l.length-1]),q=null,n.next())}else this.dIa(q),g=this.gl(q,g),n.next(),q=null;if(this.awc&&0<y.length)for(y[y.length-1]instanceof iP&&y[y.length-1].ezb(),n=h[h.length-1]/l[l.length-1]||1,r=0,B=q=z=null,v=0;v<y.length;++v)if(this.aTa&&!this.$yc)y[v]instanceof iP?g=this.gl(y[v],g):y[v]instanceof jP&&y[v].r$c(),this.dIa(y[v]);else if(E=y[v],E instanceof iP){if(0<E.HSd()){for(t=0===v?0:l[v-1]*n;h[r]<t&&r<
h.length-1;)r++;u=0===r?0:h[r-1];u=(t-u)/(h[r]-u);t=0===r?this.Aq.Ub(0):k[r-1];var H=t*(1-u)+k[r]*u;for(t=l[v]*n;h[r]<t&&r<h.length-1;)r++;u=0===r?0:h[r-1];u=(t-u)/(h[r]-u);t=0===r?this.Aq.Ub(0):k[r-1];var F=t*(1-u)+k[r]*u;t=E.C6d();u=E.Zzd();w=p.Ma(t);x=t.getX()-u.getX();C=t.getY()-u.getY();x=b(x,C);X.jf(w.getX(),w.getY(),this.$K);X.multiply(this.Ce,this.$K,A);this.Ce.Ma(w,this.DN);X.Ui(x,this.DN.getX(),this.DN.getY(),this.$K);X.multiply(this.$K,A,A);x=0===A.Gg?Math.abs(A.uf):Math.sqrt(A.uf*A.uf+
A.Mg*A.Mg);C=0===A.Mg?Math.abs(A.Ef):Math.sqrt(A.Ef*A.Ef+A.Gg*A.Gg);0>this.Ce.Ef&&(C=-C);0>this.Ce.uf&&(x=-x);t=N.xf(t,u);w=F-H;C=Math.abs(w)>W.Tb?1/C*(t/w):1;X.Cl(m/x,C,this.$K);X.multiply(A,this.$K,A);X.jf(-this.zx/2,-H,this.$K);X.multiply(A,this.$K,A);E.Sb(A);E.pBa(new U(0,H,this.zx,F));E.update();q&&B?(q.r$c(),this.dIa(q)):z&&B&&(z.pBa(new U(B.Sf().ka(),B.vg(),B.Sf().na(),E.Gf())),this.dIa(z));q=z=null;B=E}this.dIa(E);g=this.gl(E,g)}else this.aTa?q=E instanceof jP?E:null:z=E instanceof lP?E:null;
1<this.ja.Ge.length&&(this.ja.sSa=Math.pow(this.ja.sSa,1/this.ja.Ge.length),this.ja.tSa=Math.pow(this.ja.tSa,1/this.ja.Ge.length));0===this.ja.hT&&(this.ja.hT=1);0===this.ja.iT&&(this.ja.iT=1);0===this.ja.Kfa&&(this.ja.Kfa=1);0===this.ja.Lfa&&(this.ja.Lfa=1);g=Infinity;h=this.ja.iH.aqa();for(k=h.length-1;0<=k;--k)l=h[k],l.tw.yNa=g,g=Math.min(g,l.tw.i8.la());this.a8d()};d.prototype.gl=function(g,h){var k=g.QY();g=g.RY();this.ja.sSa*=k;this.ja.tSa*=g;h?(this.ja.hT=Math.max(k,this.ja.hT),this.ja.iT=
Math.max(g,this.ja.iT),this.ja.Kfa=Math.min(k,this.ja.Kfa),this.ja.Lfa=Math.min(g,this.ja.Lfa)):(this.ja.hT=k,this.ja.iT=g,this.ja.Kfa=k,this.ja.Lfa=g,h=!0);return h};d.prototype.dIa=function(g){var h=g.ga(),k=new mP(this.ja.Ge.length,h);h=h.ma()-this.Ce.Pe();this.ja.iH.vo(new nP(h,k));this.ja.Ge.push(g)};d.prototype.D0c=function(){if(this.jEa.length>=f){for(var g=Infinity,h=0,k=0;k<this.jEa.length;++k){var l=this.jEa[k];if(g>l.value.SW&&(h=k,g=l.value.SW,1===g))break}this.jEa.splice(h,1)}this.jEa.push({key:e(this.Ce),
value:this.ja})};d.prototype.shift=function(g){var h=g.cf()-this.Ce.cf(),k=g.Pe()-this.Ce.Pe();if(Math.abs(h)>W.Tb||Math.abs(k)>W.Tb){this.DN.Da(h,k);X.jf(h,k,this.$K);h=null;for(var l=0;l<this.ja.Ge.length;++l)this.ja.Ge[l].offset(this.DN),this.ja.Ge[l].BWd(h),h=this.ja.Ge[l];h=this.ja.iH.aqa();for(l=0;l<h.length;++l){var m=h[l];m.tw.yNa+=k;this.$K.Ua(m.tw.i8,m.tw.i8)}}this.Ce=this.ja.Ce=g};d.prototype.cdb=function(){return this.Ce};d.prototype.sza=function(){if(!this.Va){var g=null;this.ja.Ge.forEach(function(h){g?
g.union(h.ga()):g=h.ga()});this.Va=g}return this.Va};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRMb3dlckluZGV4IjoiUTEiLCJpbnZlcnNlVHJhbnNmb3JtIjoic2MiLCJ0cmFuc2Zvcm1MaW5lIjoidEciLCJ0cmFuc2Zvcm1MaW5lcyI6ImJLIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiaXlhIiwiZmluZEJvdW5kcyI6InpXYSIsInNjYWxlWEF0Ijoia1oiLCJzY2FsZVlBdCI6ImxaIiwibWF4U2NhbGVYIjoiUVkiLCJtYXhTY2FsZVkiOiJSWSIsIm1pblNjYWxlWCI6IldVIiwibWluU2NhbGVZIjoiWFUiLCJnZXRTdGF0aW9uc0JvdW5kcyI6InN6YSJ9fX0g");var pP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a){YO.call(this);this.ea=G(a,{joinSegments:!0,scaleWidth:!1,minWidth:-Infinity,maxWidth:Infinity,widthScaleX:1,widthScaleY:1,approxThreshold:.5,outlineSegments:!1,outlineModelBboxAdjust:!1,trackWidthStrategy:null});this.ea.approxThresholdMd=null!=this.ea.approxThresholdMd?this.ea.approxThresholdMd:this.ea.approxThreshold}D(d,YO);L(d,"geotoolkit.deviation.PiecewiseTransformer");d.prototype.ta=function(){return G(this.ea,{})};d.prototype.setOptions=function(a){G(a,this.ea);
return this};d.prototype.ia=function(){return this.ta()};d.prototype.fa=function(a){return this.setOptions(a)};d.prototype.create=function(a,b){return new oP(a,this.ea,b)};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEiLCJnZXRQcm9wZXJ0aWVzIjoiaWEiLCJzZXRQcm9wZXJ0aWVzIjoiZmEifX19");var qP=/*#__PURE__*/function(){function d(c,e,f){Fh.call(this,c,e,f)}var a=new X,b=new N;D(d,Fh);d.prototype.render=function(c,e,f,g,h,k,l,m,n){c.qg?(f=c.qg.transform(b.Da(e+this.ca()/2,f+this.da()/2),a),e=f.getX()-this.ca()/2,f=f.getY()-this.da()/2,g||h?Fh.prototype.render.call(this,c.xba(),e,f,g,h,k,l,m,n):Fh.prototype.render.call(this,c.xba(),e,f)):hb("context must be instanceof geotoolkit.renderer.DeviatedRenderingContext")};return d}();var rP=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(n){Qj.call(this);this.Ce=null!=n?n:new X;this.twb=null;this.ea={};this.ea.trajectory=null;this.ea.transformer=new pP;this.ea.trackWidth=100;this.ea.offset=0;this.ea.clip=!0;this.ea.webglrendering=!1;this.qg=this.oe=null;this.ja=[];this.HN=new X;this.ona=new N;this.hEa=this.gEa=NaN;this.vRa=this.On=null;this.Lh=[0,0,0,0];this.nHa=[];this.GP=this.y$=this.BI=null;this.BXb=this.pHa=!1}function a(n){return n instanceof Ti&&n.IA()}var b=function(){function n(p,q){this.jd=p;
this.td=q;this.Va=new U(0,0,this.jd,this.td);this.Yqb=new Fh(this.jd,this.td,!0);this.cW=this.Yqb.Mxa(this.jd,this.td);this.pqb=!0;this.SFa=vd.fZa()||vd.Kgb();this.ASa=Number.POSITIVE_INFINITY;this.ctb=Number.NEGATIVE_INFINITY;this.BSa=Number.POSITIVE_INFINITY;this.dtb=Number.NEGATIVE_INFINITY}n.prototype.ca=function(){return this.jd};n.prototype.da=function(){return this.td};n.prototype.clear=function(){if(null==this.cW)return this;for(var p=this.cW.getData(),q=4*this.cW.ca()*this.cW.da(),r=0;r<
q;r++)p[r]=0;this.SFa&&this.Yqb.clear();return this};n.prototype.hr=function(){!1===this.pqb&&(this.clear(),this.ASa=Number.POSITIVE_INFINITY,this.ctb=Number.NEGATIVE_INFINITY,this.BSa=Number.POSITIVE_INFINITY,this.dtb=Number.NEGATIVE_INFINITY);this.Qqd=this.cW.getData();this.pqb=!0;return this};n.prototype.tp=function(){this.Yqb.vra(this.cW,0,0)};n.prototype.yhc=function(p,q,r){this.pqb=!1;this.ASa=Math.min(p,this.ASa);this.ctb=Math.max(p,this.ctb);this.BSa=Math.min(q,this.BSa);this.dtb=Math.max(q,
this.dtb);var t=this.Qqd;p=4*(q*this.jd+p);t[p+0]=r[0];t[p+1]=r[1];t[p+2]=r[2];t[p+3]=r[3]};n.prototype.Ap=function(p,q){this.Va.setX(p).setY(q);return this};n.prototype.ga=function(){return this.Va};n.prototype.render=function(p,q,r){if(!0===this.pqb)return this;var t=this.ctb-this.ASa+1,u=this.dtb-this.BSa+1;r.drawImage(this.Yqb,this.ASa,this.BSa,t,u,p+this.ASa,q+this.BSa,t,u);return this};return n}(),c=function(){function n(p,q){this.CQ=p;this.Va=q;this.sf=Math.ceil(q.ca()/p.ca());this.bg=Math.ceil(q.da()/
p.da())}n.prototype.YXa=function(){return this.bg};n.prototype.vAb=function(){return this.sf};n.prototype.bMd=function(p,q){p=this.Va.ka()+p*this.CQ.ca();q=this.Va.la()+q*this.CQ.da();return this.CQ.Ap(p,q)};return n}(),e=new N(0,0),f=new N(0,0),g=new N(0,0),h=new N(0,0);D(d,Qj);d.prototype.sp=function(){if(!this.oe)throw Error("Parent rendering context is not defined");};d.prototype.LSc=function(){return{filter:this.ea.filter,trajectory:this.ea.trajectory,trackWidth:this.ea.trackWidth,offset:this.ea.offset}};
d.prototype.tD=function(n){G(n,this.ea);this.qg&&this.ea.transformer&&(n=this.HN,"function"==typeof this.qg.cdb&&(n=this.qg.cdb()),this.ea.transformer.setOptions(this.ea),this.qg=this.ea.transformer.create(this.LSc(),n))};d.prototype.kl=function(){return this.ea};d.prototype.gR=function(){return this.qg?{Lyd:this.qg.pRc()}:{}};d.prototype.xba=function(){return this.oe};d.prototype.update=function(n){this.flb(n.Ea());this.oe=n;this.setFilters(this.oe?this.oe.getFilters():null)};d.prototype.flb=function(n){n&&
(this.ea.transformer.setOptions(this.ea),this.qg?this.qg.update(n):this.qg=this.ea.transformer.create(this.LSc(),n));this.Ce.Zjb()};d.prototype.bc=function(n){n=X.multiply(this.Ce,n);n=new d(n);n.tD(this.kl());n.setFilters(this.getFilters());n.Y_a(this.BI);this.oe.Sh(this.GP);n.qg=this.qg;n.oe=this.oe;return n};d.prototype.Ea=function(){return this.Ce};d.prototype.Sb=function(n){this.Ce=n;this.y$=this.twb=null;return this};d.prototype.bq=function(){null==this.twb&&(this.twb=this.Ce.xc());return this.twb};
d.prototype.Ma=function(n){return this.qg.transform(n,this.Ce)};d.prototype.tG=function(n,p,q){q||(q=[]);this.qg.bK([n,p],q,this.Ce);return q};d.prototype.Bc=function(n,p,q,r){n instanceof U?(e.Da(n.ka(),n.la()),f.Da(n.ka()+n.ca(),n.la()+n.da())):(e.Da(n,p),f.Da(n+q,p+r));n=[e.getX(),f.getX(),f.getX(),e.getX(),e.getX()];p=[e.getY(),e.getY(),f.getY(),f.getY(),e.getY()];this.tk(n,p);return this};d.aoc=new b(256,256);d.prototype.EGb=function(n,p,q,r,t,u,w,y,z,x){if(w===z||y===x)return this;var C=null;
"function"===typeof this.On.sR&&(null!=this.vRa&&(q=this.vRa.ka(),r=this.vRa.la(),t=this.vRa.na(),u=this.vRa.ma()),C=this.On.sR(q,r,t,u));if(!C)return this;q=1;r=[];t=[];if(1!==q)for(w*=q,y*=q,z*=q,x*=q,u=0;u<n.length;++u)r.push(n[u]*q),t.push(p[u]*q);else r=n,t=p;w=Math.floor(w);y=Math.floor(y);z=Math.ceil(z);x=Math.ceil(x);p=z-w+1;n=x-y+1;if(0>w+p||0>y+n)return this;w=new U(w,y,z,x);(x=this.oe.mg().clone())&&1!==q&&x.cb(x.ka()*q,x.la()*q,x.na()*q,x.ma()*q);if(!1===w.Dd(x))return this;w.intersect(x);
if(w.isEmpty())return this;w.cb(Math.floor(w.ka()),Math.floor(w.la()),Math.ceil(w.na()),Math.ceil(w.ma()));n=w.da();p=this.Ce.xc();if(r[0]!==r[r.length-1]||t[0]!==t[t.length-1])r.push(r[0]),t.push(t[0]);u=[{}];var A=new c(d.aoc,w),v=d.aoc.ca(),B=this.oe.Ea();this.oe.Sb(X.xk);for(var E=0;E<A.YXa();E++)for(var H=0;H<A.vAb();H++){var F=A.bMd(H,E),I=F.ga();if(null==x||!1!==x.Dd(F.ga())){F.hr();w=F.ga().ka();y=F.ga().la();z=F.ga().na();F.ga();for(var J=0;J<n;++J){var K=y+J;if(!x||!(K<x.la()||K>x.ma()))for(var M=
cP.UBd(r,t,K,u),P=0;P<M.length;++P){var R=M[P];if(!(1>R.Re-R.from)){var Q=Math.floor(R.from);Q<w&&(Q=w);var V=Math.ceil(R.Re);V>z&&(V=z);var Z=Math.ceil(R.from)-R.from;R=R.Re-Math.floor(R.Re);for(var aa=Q;aa<=V;++aa){var na=aa-w;if(!(0>na||na>=I.ca()||0>J||J>=I.da()||x&&!x.contains(aa,K))){e.Da(aa/q,K/q);var ya=this.qg.sc(e);isNaN(ya.getX())||isNaN(ya.getY())||(p.Ma(ya,ya),C.ro(ya.getX(),ya.getY(),this.Lh),aa===Q&&0!==na?this.Lh[3]=Math.round(Z*this.Lh[3]):aa===V&&na!==v&&(this.Lh[3]=Math.round(R*
this.Lh[3])),F.yhc(na,J,this.Lh))}}}}}F.tp();F.render(w/q,y/q,this.oe)}}this.oe.Sb(B);return this};d.prototype.e4b=function(){this.pHa=!1;var n=Ti.Saa(Si.Uo(),this.GP.Zp()),p=this.Ce;this.GP instanceof ek&&(p=p.clone().scale(this.GP.ca(),this.GP.da()).translate(0,-1));var q=this.qg.transform(n,p);n=q.getX();var r=q.getY(),t=this.qg.sc(q);W.Hq(t.getX())&&W.Hq(t.getY())&&(this.ona.Da(0,t.getY()),q=this.qg.transform(this.ona,this.HN),this.ona.Da(this.ea.trackWidth,t.getY()),t=this.qg.transform(this.ona,
this.HN),t=Math.atan2(t.getY()-q.getY(),t.getX()-q.getX()),q=0>p.lb()?-1:1,p=0>p.Ab()?-1:1,t=X.Ui(t,0,0),n=X.jf(n,r),r=(new X).scale(q,p),X.multiply(t,r,r),X.multiply(n,r,r),n=this.oe.Ea(),this.oe.Sb(r),r=this.GP.al(),this.GP.xb(!1),this.GP.Jb(0,0),this.GP.render(this.oe),this.GP.Jb(r),this.GP.xb(!0),this.oe.Sb(n))};d.prototype.tk=function(n,p,q,r){this.sp();if(!this.ea.trajectory)return this;if(a(this.GP))return this.e4b(),this;if(this.pHa)return this;var t=Math.min(n.length,p.length),u=[];r=q=Number.POSITIVE_INFINITY;
var w=Number.NEGATIVE_INFINITY,y=Number.NEGATIVE_INFINITY,z;for(z=0;z<t;++z){var x=n[z];var C=p[z];x<q&&(q=x);C<r&&(r=C);x>w&&(w=x);C>y&&(y=C);u.push(new N(n[z],p[z]))}q=Math.floor(q);r=Math.floor(r);w=Math.ceil(w);y=Math.ceil(y);this.ja=[];this.qg.bK(u,this.ja,this.Ce,!0);n=[];p=[];u=t=Number.POSITIVE_INFINITY;var A=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(z=0;z<this.ja.length;++z)x=this.ja[z].getX(),C=this.ja[z].getY(),x<t&&(t=x),C<u&&(u=C),x>A&&(A=x),C>v&&(v=C),n.push(x),p.push(C);
if(n[n.length-1]!==n[0]||p[p.length-1]!==p[0])n.push(n[0]),p.push(p[0]);x=0;C=n.length-1;this.ja=[];z=this.oe.Ea();this.oe.Sb(this.HN);this.On&&this.EGb(n,p,q,r,w,y,t,u,A,v);this.oe.tk(n,p,x,C);this.oe.Sb(z);return this};d.prototype.Um=function(n,p,q,r){this.sp();if(!this.ea.trajectory)return this;void 0===q&&(q=0,r=Math.min(n.length,p.length)-1);if(r<=q)return this;for(var t=[];q<=r;++q)t.push(new N(n[q],p[q]));this.ja=[];this.qg.bK(t,this.ja,this.Ce,!1);n=[];p=[];for(q=0;q<this.ja.length;++q)n.push(this.ja[q].getX()),
p.push(this.ja[q].getY());q=0;r=n.length-1;this.ja=[];t=this.oe.Ea();this.oe.Sb(this.HN);this.oe.Um(n,p,q,r);this.oe.Sb(t);return this};d.prototype.eJc=function(n){var p=this.ea.trajectory;this.oe.qa(n);this.oe.Um(p.dc,p.rc,0,p.dc.length-1)};d.prototype.Xc=function(n,p,q,r){this.sp();if(!this.ea.trajectory)return this;e.Da(n,p);f.Da(q,r);this.ja=[];this.qg.bK([e,f],this.ja,this.Ce);n=[];p=[];for(q=0;q<this.ja.length;++q)n.push(this.ja[q].getX()),p.push(this.ja[q].getY());q=0;r=n.length-1;this.okc([e,
f],this.ja);this.ja=[];var t=this.oe.Ea();this.oe.Sb(this.HN);this.oe.Um(n,p,q,r);this.oe.Sb(t);return this};d.prototype.yxb=function(n,p,q,r){e.Da(n.mqa(),n.pqa());f.Da(n.nqa(),n.qqa());g.Da(n.oqa(),n.rqa());h.Da(n.zia(),n.Aia());n=W.woa(e,f,g,h);this.ja=[];this.qg.bK(n,this.ja,this.Ce,!1);for(n=0;n<this.ja.length;++n){var t=this.ja[n].getX(),u=this.ja[n].getY();t<r.fF&&(r.fF=t);u<r.hF&&(r.hF=u);t>r.eF&&(r.eF=t);u>r.gF&&(r.gF=u);p.push(t);q.push(u)}};d.prototype.Cq=function(n,p,q,r){this.sp();if(!this.ea.trajectory)return this;
if(a(this.GP))return this.e4b(),this;var t=n,u=p,w=n+q,y=p+r;n+=q/2;p+=r/2;r=Xg.lpa(n,p,q,r);n=[];p=[];q={fF:Number.POSITIVE_INFINITY,hF:Number.POSITIVE_INFINITY,eF:Number.NEGATIVE_INFINITY,gF:Number.NEGATIVE_INFINITY};for(var z=0;z<r.length;++z)this.yxb(r[z],n,p,q);r=this.oe.Ea();this.oe.Sb(this.HN);this.On&&this.EGb(n,p,t,u,w,y,q.fF,q.hF,q.eF,q.gF);this.oe.tk(n,p);this.oe.Sb(r);return this};d.prototype.Ey=function(n,p,q,r,t,u,w,y){this.sp();if(!this.ea.trajectory)return this;if(u-t>=2*Math.PI)return this.Cq(n,
p,q,r),this;var z=n,x=p,C=n+q,A=p+r;n+=q/2;p+=r/2;w=[];var v=[];if(!y){var B=this.qg.transform(new N(n,p),this.Ce);w.push(B.getX());v.push(B.getY())}n=Xg.lpa(n,p,q,r,t,u);if(1>n.length)return this;p={fF:Number.POSITIVE_INFINITY,hF:Number.POSITIVE_INFINITY,eF:Number.NEGATIVE_INFINITY,gF:Number.NEGATIVE_INFINITY};for(q=0;q<n.length;++q)this.yxb(n[q],w,v,p);n=this.oe.Ea();this.oe.Sb(this.HN);if(y)if(this.BXb)for(y=0;y<w.length;++y)p=g.Da(w[y],v[y]),this.oe.lineTo(p.getX(),p.getY());else this.oe.Um(w,
v);else this.oe.tk(w,v);this.oe.Sb(n);if(this.On){this.OGb();this.mK={fF:z,hF:x,eF:C,gF:A};for(z=0;z<w.length;++z){x=Math.round(w[z]);C=Math.round(v[z]);A=this.Vga.length;if(0===A||this.Vga[A-1]!==x&&this.lxa[A-1]!==C)this.Vga.push(x),this.lxa.push(C);w[z]<this.fB.fF&&(this.fB.fF=w[z]);v[z]<this.fB.hF&&(this.fB.hF=v[z]);w[z]>this.fB.eF&&(this.fB.eF=w[z]);v[z]>this.fB.gF&&(this.fB.gF=v[z])}this.oe.Sb(this.HN);this.EGb(this.Vga,this.lxa,this.mK.fF,this.mK.hF,this.mK.eF,this.mK.gF,this.fB.fF,this.fB.hF,
this.fB.eF,this.fB.gF);this.OGb();this.oe.Sb(n)}return this};d.prototype.pJ=function(n,p,q,r,t,u){this.sp();if(!this.ea.trajectory)return this;var w=u-t>=2*Math.PI;w&&(t=0,u=2*Math.PI);q=Xg.lpa(n,p,2*q,2*q,t,u);n=Xg.lpa(n,p,2*r,2*r,t,u,!0);if(w){this.beginPath();p=q[0];this.moveTo(p.mqa(),p.pqa());for(w=0;w<q.length;++w)p=q[w],this.bezierCurveTo(p.nqa(),p.qqa(),p.oqa(),p.rqa(),p.zia(),p.Aia());p=n[n.length-1];this.moveTo(p.zia(),p.Aia());for(w=n.length-1;0<=w;--w)p=n[w],this.bezierCurveTo(p.oqa(),
p.rqa(),p.nqa(),p.qqa(),p.mqa(),p.pqa());this.closePath();this.oe.Si();this.oe.stroke()}else{p=[];r=[];t={fF:Number.POSITIVE_INFINITY,hF:Number.POSITIVE_INFINITY,eF:Number.NEGATIVE_INFINITY,gF:Number.NEGATIVE_INFINITY};for(w=0;w<q.length;++w)this.yxb(q[w],p,r,t);for(w=0;w<n.length;++w)this.yxb(n[w],p,r,t);q=this.oe.Ea();this.oe.Sb(this.HN);this.oe.tk(p,r);this.oe.Sb(q)}return this};var k=new uh([],[]),l=new uh([],[]),m=wc(100,100);d.prototype.drawImage=function(n,p,q,r,t,u,w,y,z){"function"===typeof n.Sk&&
(n=n.Sk());void 0===r&&(r=n.width,t=n.height,u=p,w=q,y=r,z=t,q=p=0);var x=this.Ce.transform(new U(u,w,u+y,w+z)),C=Math.ceil(x.ca()),A=Math.ceil(x.da());if(0!==C&&0!==A){var v=Math.ceil(x.na()),B=Math.ceil(x.ma());m.width=v;m.height=B;v=m.getContext("2d");v.setTransform(this.Ce.uf,this.Ce.Mg,this.Ce.Gg,this.Ce.Ef,this.Ce.gi,this.Ce.Vh);v.drawImage(n,p,q,r,t,u,w,y,z);x=v.getImageData(Math.floor(x.ka()),Math.floor(x.la()),C,A).data;v.setTransform(1,0,0,1,0,0);B=this.Ce.transform(new N(u,w),e);var E=
this.Ce.transform(new N(u+y,w),f),H=this.Ce.transform(new N(u,w+z),g);w=this.Ce.transform(new N(u+y,w+z),h);u=new uh([B.x,E.x,w.x,H.x],[B.y,E.y,w.y,H.y]);this.qg.bK([B,E,w,H],this.ja,this.HN,!0);if(3>this.ja.length)this.ja=[];else if(this.ea.webglrendering){v=[];x=[];u=[];B=[];E=[];var F=Number.POSITIVE_INFINITY;z=Number.POSITIVE_INFINITY;var I=Number.NEGATIVE_INFINITY,J=Number.NEGATIVE_INFINITY;A=C=Number.POSITIVE_INFINITY;w=H=Number.NEGATIVE_INFINITY;for(y=0;y<this.ja.length;y++){var K=this.ja[y],
M=this.Ce.sc(this.qg.sc(K)),P=M.getX(),R=M.getY();isNaN(P)||isNaN(R)?E.push(null):(E.push(M),F=Math.min(P,F),z=Math.min(R,z),I=Math.max(P,I),J=Math.max(R,J),M=K.getX(),K=K.getY(),C=Math.min(M,C),A=Math.min(K,A),H=Math.max(M,H),w=Math.max(K,w))}if(!W.equals(H,C,1)&&!W.equals(w,A,1)){K=(I-F)*n.width/r;M=(J-z)*n.height/t;p=F+p/r*(I-F);q=z+q/t*(J-z);for(y=0;y<this.ja.length;y++)null!=E[y]&&(v.push((E[y].getX()-p)/K),x.push((E[y].getY()-q)/M),u.push(this.ja[y].getX()-C),B.push(this.ja[y].getY()-A));v=
fH.hja(n,{width:H-C,height:w-A,source:{x:u,y:B},destination:{x:v,y:x}});x=this.oe.Ea();this.oe.Sb(this.HN);this.oe.drawImage(v,C,A);this.oe.Sb(x)}}else{r=[];z=[];n=y=Infinity;t=q=-Infinity;for(p=0;p<this.ja.length;++p)J=this.ja[p].getX(),F=this.ja[p].getY(),J<y&&(y=J),F<n&&(n=F),J>q&&(q=J),F>t&&(t=F),r.push(J),z.push(F);this.ja=[];p=new wh;p.union(k.ne(r,z),p);r=Math.min(B.x,E.x,H.x,w.x);B=Math.min(B.y,E.y,H.y,w.y);y=Math.floor(y);n=Math.floor(n);q=Math.ceil(q);t=Math.ceil(t);E=Math.min(100,Math.max(q-
y,t-n));m.width=E;m.height=E;H=this.oe.Ea();this.oe.Sb(this.HN);for(J=y;J<q;J+=E)for(F=n;F<t;F+=E)if(I=v.createImageData(E,E),w=Math.min(J+E,q),z=Math.min(F+E,t),l.ne([J,w,w,J],[F,F,z,z]),K=p.intersect(l),K.length){M=Infinity;w=z=-Infinity;y=Infinity;for(P=0;P<K.length;P++)M=Math.min(M,Math.min.apply(null,K[P].be())),w=Math.max(w,Math.max.apply(null,K[P].be())),z=Math.max(z,Math.max.apply(null,K[P].He())),y=Math.min(y,Math.min.apply(null,K[P].He()));K=!1;for(M=Math.floor(M);M<Math.ceil(w);++M)for(P=
Math.floor(y);P<Math.ceil(z);++P){var Q=R=0,V=0,Z=0,aa=e.Da(M,P),na=M-J,ya=P-F,va=this.qg.sc(aa),qa=g.Da(cP.gG(va.getX()-r),cP.gG(va.getY()-B));if(u.contains(va.getX(),va.getY())&&(va=this.qg.Maa(aa,1))){for(var Ja=aa=0;Ja<va.getSize();++Ja){var Qa=va.get(Ja),Oa=qa.x+Qa.gi,Ua=qa.y+Qa.Vh;0>Oa||0>Ua||Oa>=C||Ua>=A||(Oa=4*(Oa+Ua*C),R+=x[Oa++]*Qa.area,Q+=x[Oa++]*Qa.area,V+=x[Oa++]*Qa.area,Z+=x[Oa]*Qa.area,aa+=Qa.area)}Z<W.Tb||0===aa||(K=4*(na+ya*E),I.data[K++]=R/aa,I.data[K++]=Q/aa,I.data[K++]=V/aa,I.data[K]=
Z/aa,K=!0)}}K&&(v.clearRect(0,0,E,E),v.putImageData(I,0,0),this.oe.drawImage(m,J,F))}this.oe.Sb(H)}}};d.prototype.le=function(n,p,q){this.sp();if(!this.ea.trajectory)return this;if(a(this.GP))return this.e4b(),this;var r=this.qg.transform(new N(n,p),this.Ce);p=this.qg.transform(new N(n+1,p),this.Ce);n=this.oe.Ea();p=Math.atan2(p.getY()-r.getY(),p.getX()-r.getX());p=X.Ui(p,r.getX(),r.getY());this.oe.Sb(p);this.oe.le(r.getX(),r.getY(),q);this.oe.Sb(n);return this};d.prototype.beginPath=function(){this.sp();
if(!this.ea.trajectory)return this;this.OGb();this.oe.beginPath();return this};d.prototype.moveTo=function(n,p){this.sp();if(!this.ea.trajectory||this.pHa)return this;this.tsc=n;this.usc=p;this.gEa=n;this.hEa=p;e.Da(n,p);e=this.qg.transform(e,this.Ce);n=this.oe.Ea();n.rd(e,e);this.oe.moveTo(e.getX(),e.getY());return this};d.prototype.OGb=function(){this.mK={fF:Number.POSITIVE_INFINITY,hF:Number.POSITIVE_INFINITY,eF:Number.NEGATIVE_INFINITY,gF:Number.NEGATIVE_INFINITY};this.fB={fF:Number.POSITIVE_INFINITY,
hF:Number.POSITIVE_INFINITY,eF:Number.NEGATIVE_INFINITY,gF:Number.NEGATIVE_INFINITY};this.Vga=[];this.lxa=[]};d.prototype.okc=function(n,p){if(this.On&&this.mK)for(n=Hd.getBoundingBox(n),n.ka()<this.mK.fF&&(this.mK.fF=n.ka()),n.la()<this.mK.hF&&(this.mK.hF=n.la()),n.na()>this.mK.eF&&(this.mK.eF=n.na()),n.ma()>this.mK.gF&&(this.mK.gF=n.ma()),n=Hd.getBoundingBox(p),n.ka()<this.fB.fF&&(this.fB.fF=n.ka()),n.la()<this.fB.hF&&(this.fB.hF=n.la()),n.na()>this.fB.eF&&(this.fB.eF=n.na()),n.ma()>this.fB.gF&&
(this.fB.gF=n.ma()),this.Vga||(this.Vga=[]),this.lxa||(this.lxa=[]),n=0;n<p.length;++n){var q=p[n].getX(),r=p[n].getY(),t=this.Vga.length;1<t&&this.Vga[t-1]===q&&this.lxa[t-1]===r||(this.Vga.push(q),this.lxa.push(r))}};d.prototype.lineTo=function(n,p){this.sp();if(!this.ea.trajectory||this.pHa)return this;var q=e.Da(this.gEa,this.hEa),r=f.Da(n,p);this.ja=[];this.qg.bK([q,r],this.ja,this.Ce,!1);for(var t=this.oe.Ea(),u=0;u<this.ja.length;++u){var w=g.Da(this.ja[u].getX(),this.ja[u].getY());t.rd(w,
w);this.oe.lineTo(w.getX(),w.getY())}this.okc([q,r],this.ja);this.ja=[];this.gEa=n;this.hEa=p;return this};d.prototype.arcTo=function(n,p,q,r,t){this.sp();if(!this.ea.trajectory||this.pHa)return this;n=cP.FGc(this.gEa,this.hEa,n,p,q,r,t);this.lineTo(n.line.fbd,n.line.ibd);this.gEa=n.Yp.x;this.hEa=n.Yp.y;n=n.arc;this.BXb=!0;this.Ey(n.left,n.top,2*t,2*t,n.bx,n.rJc,void 0,!0);this.BXb=!1;return this};d.prototype.bezierCurveTo=function(n,p,q,r,t,u){this.sp();if(!this.ea.trajectory||this.pHa)return this;
this.ja=[];e.Da(this.gEa,this.hEa);f.Da(n,p);g.Da(q,r);h.Da(t,u);n=W.woa(e,f,g,h);this.qg.bK(n,this.ja,this.Ce,!1);p=this.oe.Ea();this.oe.Sb(this.HN);for(q=0;q<this.ja.length;++q)this.oe.lineTo(this.ja[q].getX(),this.ja[q].getY());this.oe.Sb(p);this.okc(n,this.ja);this.ja=[];this.gEa=t;this.hEa=u;return this};d.prototype.stroke=function(){this.sp();if(!this.ea.trajectory)return this;this.oe.stroke();return this};d.prototype.closePath=function(){this.sp();if(!this.ea.trajectory)return this;void 0!==
this.tsc&&void 0!==this.usc&&this.lineTo(this.tsc,this.usc);this.oe.closePath();return this};d.prototype.Si=function(){this.sp();this.On&&!1===this.fc()?(this.EGb(this.Vga,this.lxa,this.mK.fF,this.mK.hF,this.mK.eF,this.mK.gF,this.fB.fF,this.fB.hF,this.fB.eF,this.fB.gF),this.OGb()):this.oe.Si();return this};d.prototype.kb=function(n){this.sp();if(!this.ea.trajectory)return this;this.oe.kb(n);return this};d.prototype.getParent=function(){this.sp();return this.oe.getParent()};d.prototype.sL=function(){this.sp();
return this.oe.sL()};d.prototype.oL=function(){this.sp();return this.oe?this.oe.oL():null};d.prototype.Ez=function(n,p,q){this.sp();return new qP(n,p,q)};d.prototype.Y_a=function(n){this.uD(n);return this};d.prototype.uD=function(n){this.BI=null!=n?n.clone():null;this.y$=null};d.prototype.cy=function(n){if(null!=n){var p=this.Ea();null!=p&&(n=p.Ua(n));this.uD(n)}};d.prototype.mg=function(){return null==this.BI?new U(0,this.ea.trajectory.Zf(),this.ea.trackWidth,this.ea.trajectory.Yf()):this.BI instanceof
U?this.BI:this.BI.ga()};d.prototype.eg=function(){null==this.y$&&(this.y$=this.bq().Ua(this.mg()));return this.y$};d.prototype.dLa=function(n,p,q){this.ja=[];this.qg.bK(n,this.ja,this.HN,q);if(!(1>this.ja.length)){q&&(n=this.ja[0],p.moveTo(n.getX(),n.getY()));for(var r=1;r<this.ja.length;++r)n=this.ja[r],p.lineTo(n.getX(),n.getY());q&&p.close();this.ja=[]}};d.prototype.uh=function(n,p,q){n instanceof wh&&(n=n.feb());if(!this.ea.clip)return this;this.sp();p=void 0!==p?p:Bd.Gp;q=void 0!==q?q:!1;null!=
n&&q&&!this.Ea().KE()&&this.Ea().transform(n,n);this.Y_a(Hd.TEb(this.BI,n,p));null==this.BI?(n=this.ea.trajectory,q=new U(0,n.Zf(),this.ea.trackWidth,n.Yf())):q=this.BI;n=new Fd;if(q instanceof U)q=q.clone().round(),e.Da(q.ka(),q.la()),f.Da(q.na(),q.la()),g.Da(q.na(),q.ma()),h.Da(q.ka(),q.ma()),this.dLa([e,f,g,h],n,!0);else if(q instanceof Fd){p=q.getTags();for(var r=q.getX(),t=q.getY(),u=new N,w=new N,y,z,x=0;x<p.length;x++){var C=q.getIndex(x);if(p[x]===Dd.cz)u.Da(r[C],t[C]),w.Da(r[C],t[C]),y=this.qg.transform(u,
this.HN),n.moveTo(y.getX(),y.getY());else if(p[x]===Dd.Zz)e.Da(r[C],t[C]),this.dLa([w,e],n),w.Da(r[C],t[C]);else if(p[x]===Dd.AD)f.Da(r[C],t[C]),g.Da(r[C+1],t[C+1]),h.Da(r[C+2],t[C+2]),z=W.woa(w,f,g,h),this.dLa(z,n),w.Da(r[C+2],t[C+2]);else if(p[x]===Dd.sS){y=cP.FGc(w.getX(),w.getY(),r[C],t[C],r[C+1],t[C+1],r[C+2]);z=y.line;e.Da(z.E9d,z.G9d);w.Da(z.fbd,z.ibd);this.dLa([e,w],n);z=y.arc;C=r[C+2];C=Xg.lpa(z.left+C,z.top+C,2*C,2*C,z.bx,z.rJc);for(var A,v=0;v<C.length;++v)A=C[v],e.Da(A.mqa(),A.pqa()),
f.Da(A.nqa(),A.qqa()),g.Da(A.oqa(),A.rqa()),h.Da(A.zia(),A.Aia()),z=W.woa(e,f,g,h),this.dLa(z,n);A&&w.Da(A.zia(),A.Aia());y=y.Yp;e.Da(y.x,y.y);this.dLa([w,e],n);w.Da(y.x,y.y)}else p[x]===Dd.iP&&(this.dLa([w,u],n),n.close())}}A=this.oe.Ea();this.oe.Sb(this.HN);this.oe.uh(n,Bd.Gp,!1);this.oe.Sb(A);return this};d.prototype.fc=function(){return this.oe?this.oe.fc():!1};d.prototype.getSelection=function(){return this.oe&&this.oe.fc()?this.oe.getSelection():[]};d.prototype.Hn=function(n,p){this.sp();this.fc()&&
(this.XLa(p),n.render(this),this.sra())};d.prototype.eV=function(n){this.sp();this.oe.fc()&&this.oe.eV(n)};d.prototype.ou=function(n){this.sp();this.oe.fc()&&this.oe.ou(n);return this};d.prototype.XLa=function(n){this.sp();this.oe.XLa(n)};d.prototype.sra=function(){this.sp();this.oe.sra()};d.prototype.selectNode=function(n){this.sp();this.oe.selectNode(n)};d.prototype.measureText=function(n,p){this.sp();return this.oe.measureText(n,p)};d.prototype.save=function(){this.sp();var n=null!=this.BI?this.BI.clone():
null;this.nHa.push(n);this.oe.save();return this};d.prototype.restore=function(){this.sp();0<this.nHa.length&&this.Y_a(this.nHa.pop());this.oe.restore();return this};d.prototype.iya=function(n){this.sp();return this.qg.iya(n)};d.prototype.aJa=function(n){this.sp();return this.qg.zWa(n)};d.prototype.sza=function(){this.sp();return this.qg.sza()};d.prototype.Sh=function(n){this.sp();this.oe.Sh(n);this.GP=n;a(this.GP)&&(this.pHa=!0);return this};d.prototype.BX=function(){this.sp();this.oe.BX();return this};
d.prototype.KX=function(){this.sp();this.oe.KX();return this};d.prototype.Gv=function(n){this.sp();this.oe.Gv(n);return this};d.prototype.ra=function(n,p){this.sp();n?n instanceof uf&&!1===this.fc()?(this.vRa=p,this.On=n,this.oe.ra(null)):(this.On=null,this.oe.ra(n,p)):(this.On=null,this.oe.ra(n,p));return this};d.prototype.eb=function(){this.sp();return this.On?this.On:"function"===typeof this.oe.eb?this.oe.eb():null};d.prototype.qa=function(n,p){this.sp();this.oe.qa(n,p);return this};d.prototype.Ih=
function(n){this.oe.Ih(n);return this};d.prototype.xo=function(){this.oe.xo();return this};d.prototype.wJa=function(n,p){var q=0;n=this.tG(n,p);for(p=0;p<n.length-1;++p)q+=N.xf(n[p],n[p+1]);return q};d.prototype.oda=function(n){this.ea.webglrendering=n;return this};d.prototype.Iza=function(){return this.ea.webglrendering};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJzZXREZXZpYXRpb24iOiJ0RCIsImdldEhpbnRzIjoiZ1IiLCJ1cGRhdGVUcmFuc2Zvcm1hdGlvbiI6ImZsYiIsInB1c2hUcmFuc2Zvcm1hdGlvbiI6ImJjIiwiZ2V0VHJhbnNmb3JtYXRpb24iOiJFYSIsInNldFRyYW5zZm9ybWF0aW9uIjoiU2IiLCJnZXRJbnZlcnNlVHJhbnNmb3JtYXRpb24iOiJicSIsImRyYXdSZWN0YW5nbGUiOiJCYyIsImRyYXdQb2x5Z29uIjoidGsiLCJkcmF3UG9seWxpbmUiOiJVbSIsImRyYXdMaW5lIjoiWGMiLCJkcmF3RWxsaXBzZSI6IkNxIiwiZHJhd0FyYyI6IkV5IiwiZHJhd0FubnVsdXNBcmMiOiJwSiIsImRyYXdUZXh0IjoibGUiLCJmaWxsUGF0aCI6IlNpIiwic2V0VGV4dFN0eWxlIjoia2IiLCJnZXRDb250ZXh0MmQiOiJzTCIsImNyZWF0ZVJlbmRlcmluZ1N0YXRlIjoib0wiLCJjcmVhdGVTdXJmYWNlIjoiRXoiLCJzZXREZXZpY2VSZWN0IjoidUQiLCJzZXRNb2RlbFJlY3QiOiJjeSIsImdldERldmljZVJlY3QiOiJtZyIsImdldE1vZGVsUmVjdCI6ImVnIiwic2V0Q2xpcCI6InVoIiwiaXNQaWNraW5nIjoiZmMiLCJwaWNrIjoiSG4iLCJwdXNoU2VsZWN0aW9uIjoiZVYiLCJzZXRTZWxlY3Rpb24iOiJvdSIsImZpbmRWaXNpYmxlVHJhamVjdG9yeVJhbmdlcyI6Iml5YSIsImZpbmRMaW5lYXJCYm94IjoiYUphIiwic2V0Q3VycmVudE5vZGUiOiJTaCIsImJlZ2luUmVuZGVyaW5nIjoiQlgiLCJlbmRSZW5kZXJpbmciOiJLWCIsInNldEZpbGxQYXR0ZXJuIjoiR3YiLCJzZXRGaWxsU3R5bGUiOiJyYSIsImdldEZpbGxTdHlsZSI6ImViIiwic2V0TGluZVN0eWxlIjoicWEiLCJzZXRIaW50cyI6IkloIiwicmVzZXRIaW50cyI6InhvIiwiZ2V0RGV2aWNlUGF0aExlbmd0aCI6IndKYSIsInNldFdlYkdMUmVuZGVyaW5nIjoib2RhIiwiZ2V0V2ViR0xSZW5kZXJpbmciOiJJemEifX19");var $U=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a){aP.call(this);a=G(a,{minWidth:1,maxWidth:Infinity,aspectratio:10});this.PW=a.minWidth;this.JW=a.maxWidth;this.RPb=a.aspectratio}D(d,aP);L(d,"geotoolkit.deviation.AspectRatioTrackWidthStrategy");d.prototype.ca=function(a,b){var c=b.trajectory;2>c.count()?a=b.width*a.lb():(a=this.A6b(c,a),a=a.deviceLength/this.RPb);a<this.PW&&(a=this.PW);a>this.JW&&(a=this.JW);return a};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIn19fSAg");var aV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(c,e,f){e=(e.getY()-c.getY())/(e.getX()-c.getX());if(!isFinite(e))return Number.NaN;c=c.getY()-e*c.getX();return f=e*f+c}function a(c,e,f){e=(e.getY()-c.getY())/(e.getX()-c.getX());if(!isFinite(e))return Number.NaN;c=c.getY()-e*c.getX();return f-=c/e}function b(c,e,f){Ui.call(this);this.D4=c;this.vrd=e;this.vd=f;this.HK=[new N,new N];this.$rc=this.Aq=null;this.z_b=[]}D(b,Ui);L(b,"geotoolkit.deviation.axis.DeviatedValueTransformer");b.prototype.EMd=function(c,e){if(!c.equals(this.Aq)||
!e.cdb().o1(this.$rc)){var f=new N;this.z_b=[];for(var g=0;g<c.count();++g){f.Da(0,c.Ub(g));var h=e.transform(f);this.z_b.push(h)}this.Aq=c;this.$rc=e.cdb()}return this.z_b};b.FMd=function(c){if(!c||1>c.length)return null;for(var e=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k,l,m,n,p,q,r,t,u=0;u<c.length;++u){var w=c[u],y=w.getX(),z=w.getY();y<e&&(e=y,k=w,p=u);y>g&&(g=y,m=w,r=u);z<f&&(f=z,l=w,q=u);z>h&&(h=z,n=w,t=u)}return{GTc:p,HTc:q,
ETc:r,FTc:t,QWd:k,RWd:l,OWd:m,PWd:n}};b.prototype.DA=function(){return this.vd};b.prototype.transform=function(c){if(!this.D4.kl())return c;var e=this.D4.kl().trajectory;if(!e||2>e.count())return c;var f=this.D4.KMc();if(!f)return c;var g=this.vd.Kg()===Rh.rb,h=this.vd.sSc().Po(),k=this.D4.getRoot().uL();g?(h=c*h.Ab()+h.Pe(),this.HK[0].Da(k.ka(),h),this.HK[1].Da(k.na(),h)):(h=c*h.lb()+h.cf(),this.HK[0].Da(h,k.la()),this.HK[1].Da(h,k.ma()));k=this.EMd(e,f);var l=dP.PKa(this.HK,k);if(null==l&&k&&0<
k.length){var m=b.FMd(k);if(m)if(g){var n;h<=m.RWd.getY()?0===m.HTc?n=a(k[0],k[1],h):m.HTc===k.length-1&&(n=a(k[k.length-2],k[k.length-1],h)):h>=m.PWd.getY()&&(0===m.FTc?n=a(k[0],k[1],h):m.FTc===k.length-1&&(n=a(k[k.length-2],k[k.length-1],h)));isFinite(n)&&(l=new N(n,h))}else{var p;h<=m.QWd.getX()?0===m.GTc?p=d(k[0],k[1],h):m.GTc===k.length-1&&(p=d(k[k.length-2],k[k.length-1],h)):h>=m.OWd.getX()&&(0===m.ETc?p=d(k[0],k[1],h):m.ETc===k.length-1&&(p=d(k[k.length-2],k[k.length-1],h)));isFinite(p)&&(l=
new N(h,p))}}if(null==l)return c;f=f.sc(l);if(null===f||!W.Hq(f.getX())||!W.Hq(f.getY()))return c;f=f.getY();f=this.vrd.transform(f,!1);return c=(e=e.hUc(f))?g?e.getY():e.getX():c};return b}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRBeGlzIjoiREEifX19");var bV=/*#__PURE__*/ta(/*#__PURE__*/{tc:"Left",Oa:"Center",cc:"Right"},2,"eyJMZWZ0IjoidGMiLCJDZW50ZXIiOiJPYSIsIlJpZ2h0IjoiY2MifSAg");var cV=/*#__PURE__*/function(){function d(a,b,c,e){this.tF=a?a:0;this.Bu=b?b:0;this.AEa=c?c:0;this.Tj=e?e:null}L(d,"geotoolkit.deviation.PiecewiseLinearApproximation");d.prototype.line=function(){return this.Tj};d.prototype.error=function(){return this.AEa};d.prototype.qtd=function(){return this.tF};d.prototype.q4b=function(){return this.Bu};d.prototype.count=function(){return this.Bu-this.tF+1};d.prototype.copy=function(a){this.tF=a.tF;this.Bu=a.Bu;this.AEa=a.AEa;this.Tj=a.Tj;return this};return d}();var dV=/*#__PURE__*/function(){function d(b,c,e){this.Aq=b;this.ard=c;this.tqb=e;this.Xta=0;this.Wna=null==b?0:b.count();this.xi=new cV;this.IRb=[];for(b=0;b<this.Wna;++b)this.IRb[b]=this.ard.Ma(this.sSd(b));this.next()}function a(){this.ood=new N;this.gT=new N;this.$wc=this.cWb=0;this.Hub=new N}L(d,"geotoolkit.deviation.PiecewiseLinearIteratorImpl");d.prototype.Qxa=function(b){return 0<=b&&b<this.Wna?this.IRb[b]:new N};d.prototype.sSd=function(b){return 0<=b&&b<this.Wna?new N(this.Aq.getX(b),this.Aq.getY(b)):
new N};d.prototype.depth=function(b){return 0<=b&&b<this.Wna?this.Aq.Ub(b):0};d.prototype.object=function(){return this.xi};d.prototype.end=function(){return 0===this.Wna||this.Xta===this.Wna-1};d.prototype.next=function(){this.xi.q4b()&&(this.Xta=this.xi.q4b());this.end()||(this.xi=this.u1b())};d.prototype.center=function(b,c){for(var e=0,f=0,g=c-b+1;b<=c;++b){var h=this.Qxa(b);e+=h.getX();f+=h.getY()}return new N(e/g,f/g)};d.prototype.dWc=function(b,c,e){for(var f=this.center(b,c),g=0,h=0,k=0;b<=
c;++b){var l=this.Qxa(b),m=l.getX()-f.getX();l=l.getY()-f.getY();g+=l*l;h-=m*l;k+=m*m}e.Hub=f;c=g+k;g=.5*(g-k);k=Math.sqrt(h*h+g*g);e.$wc=.5*c+k;e.gT.Da(-h,g-k);h=cP.uMa(e.gT,e.gT);0===h?e.gT.Da(1,0):(h=Math.sqrt(h),e.gT.Da(e.gT.getX()/h,e.gT.getY()/h));e.cWb=c-e.$wc;e.ood=new N(-e.gT.getY(),e.gT.getX())};d.prototype.Y3b=function(b,c,e,f,g){b=c*(this.depth(e)-b);f=N.xf(g,f);return Math.abs(b-f)};d.prototype.yOe=function(b,c,e){if(2>c-b)return 0;e=new eP(e.gT,-cP.uMa(e.gT,e.Hub));for(var f=0;b<=c;++b){var g=
Math.abs(e.distance(this.Qxa(b)));f<g&&(f=g)}return f};d.prototype.cvd=function(b,c,e){if(2>c-b)return!0;e=new eP(e.gT,-cP.uMa(e.gT,e.Hub));var f=e.project(this.Qxa(b)),g=e.project(this.Qxa(c)),h=this.depth(b),k=this.depth(c);if(Math.abs(k-h)<W.Tb)return!1;g=N.xf(f,g)/(k-h);for(var l,m=b+1;m<=c&&(l=e.project(this.Qxa(m)))===f;){if(this.Y3b(h,g,m,f,l)>this.tqb.getX())return!1;++m}if(m>c)return!0;l=e.project(this.Qxa(m));if(this.Y3b(h,g,m,f,l)>this.tqb.getX())return!1;b=W.sign(l.getX()-f.getX());k=
W.sign(l.getY()-f.getY());for(m+=1;m<=c;++m){var n=e.project(this.Qxa(m));if(this.Y3b(h,g,m,f,n)>this.tqb.getX())return!1;if(n!==l){if(W.sign(n.getX()-l.getX())!==b||W.sign(n.getY()-l.getY())!==k)return!1;l=n}}return!0};d.prototype.u1b=function(){var b=this.Wna-this.Xta-1,c=this.Xta+1,e=new a,f=new a;if(1<b)for(;0<b;){var g=Math.floor(b/2);var h=c+g;this.dWc(this.Xta,h,f);var k=Math.abs(f.cWb)>W.Tb?Math.sqrt(Math.abs(f.cWb)):0;if(k<=this.tqb.getY()&&this.cvd(this.Xta,h,f)){e=f;var l=k;c=h;b-=g+1}else b=
g}else this.dWc(this.Xta,this.Wna-1,e),l=0,c=this.Wna-1;return new cV(this.Xta,c,l,new eP(e.gT,-cP.uMa(e.gT,e.Hub)))};return d}();var eV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a){aP.call(this);a=G(a,{minWidth:1,maxWidth:Infinity,widthScale:25});this.PW=a.minWidth;this.JW=a.maxWidth;this.s0b=a.widthScale}D(d,aP);L(d,"geotoolkit.deviation.ProportionalWidthStrategy");d.prototype.ca=function(a,b){var c=b.width;b=b.trajectory;2>b.count()?a=1:(a=this.A6b(b,a),a=a.deviceLength/a.length);c*=this.s0b*a;c<this.PW&&(c=this.PW);c>this.JW&&(c=this.JW);return c};d.prototype.ia=function(){return{maxwidth:this.JW,minwidth:this.PW,widthscale:this.s0b}};d.prototype.fa=
function(a){a=jc(a);if(null==a)return this;a.minwidth&&(this.PW=a.minwidth);a.maxwidth&&(this.JW=a.maxwidth);a.widthscale&&(this.s0b=a.widthscale);return this};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRXaWR0aCI6ImNhIiwiZ2V0UHJvcGVydGllcyI6ImlhIiwic2V0UHJvcGVydGllcyI6ImZhIn19fSAg");var fV=/*#__PURE__*/function(){function d(b,c,e){PR.call(this,b,null,e);this.$ea=this.ik=null;this.XDa=function(){var f=this.ik.wa().transform(this.ik.wDb());this.$ea.sa(this.ab.wa().sc(f));this.eW&&this.$ea.ep(new Ne(Fd.fromRect(this.ik.getParent().wb())))}.bind(this);this.Uy(c,a(c))}function a(b){if(null==b)return null;b=b.getParent();return null==b?null:nc(b,ep)?b:a(b)}D(d,PR);L(d,"geotoolkit.deviation.tools.DeviatedAdapter");d.prototype.hs=function(){return this.ik};d.prototype.Uy=function(b,c){this.Nd=b;
this.ik=c;this.$ea=this.ik.vNa?this.ik.vNa():this.ik.clone();this.$ea.nb("ghost_node");this.XDa();this.ik.on(ze.jK,this.XDa);this.ab.pa(this.$ea);return this};d.prototype.contains=function(b){b=this.ik.sc(b);return!isNaN(b.getX())&&!isNaN(b.getY())};d.prototype.AJb=function(b,c,e){c=this.ik.sc(c);return isNaN(c.getX())||isNaN(c.getY())?!1:PR.prototype.AJb.call(this,b,c,e)};d.prototype.SJb=function(b){b=this.ik.sc(b);return isNaN(b.getX())||isNaN(b.getY())?null:this.ik.wa().transform(b)};d.prototype.Ujc=
function(b){b=this.ik.wa().sc(b);return this.ik.transform(b)};d.prototype.Jkb=function(b){b=this.ab.wa().transform(b);b=this.ik.sc(b).clone();return isNaN(b.getX())||isNaN(b.getY())?null:b};d.prototype.Ikb=function(b){if(!b)return null;b=this.ik.transform(new N(this.ik.oa().ca()/2,b.getY()));return this.ab.wa().sc(b)};d.prototype.intersect=function(b){var c=this.ik.Ix(this.ab.wa().xc());c.jUc(b);b=c.be();for(var e=c.He(),f=this.ab.wa(),g=Infinity,h=-Infinity,k=0;k<c.getSize();k++){var l=this.ik.sc(f.transform(new N(b[k],
e[k])));l.getY()<g&&(g=l.getY());l.getY()>h&&(h=l.getY())}return new U(0,g,this.ik.oa().ca(),h)};d.prototype.lWc=function(){return!0};d.prototype.mc=function(){return this.$ea};d.prototype.dispose=function(){this.ik&&(this.ik.za(ze.jK,this.XDa),this.ik=null);this.$ea&&(this.$ea.rh(),this.$ea.dispose(),this.$ea=null)};d.Ym=function(b){return null!=a(b)};d.$8b=function(){return 2};return d}();var gV=/*#__PURE__*/ta(/*#__PURE__*/{z2a:"onDeviationChanged"},2,"eyJEZXZpYXRpb25DaGFuZ2VkIjoiejJhIn0g"),hV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a){Uh.call(this,a);this.Va=this.jm=this.mj=null;this.ona=new N}D(d,Uh);mc(d,ep);L(d,"geotoolkit.scene.DeviatedCompositeNode");QR.ya().register(fV);d.kzd=!1;d.Ka=gV;d.prototype.addListener=function(a,b){this.on(a,b);return this};d.prototype.removeListener=function(a,b){this.za(a,b);return this};d.prototype.bXc=function(){this.notify(gV.z2a,this)};d.prototype.tD=function(a){null==a?this.mj=null:(this.mj||(this.mj=new rP),this.mj.tD(a));this.bXc();
this.xa();this.ha();return this};d.prototype.kl=function(){return this.mj?this.mj.kl():null};d.prototype.vNa=function(){var a=new d;a.mj=this.mj;return a};d.prototype.transform=function(a){return this.mj?this.mj.qg.transform(a):a};d.prototype.sc=function(a){return this.mj?this.mj.qg.sc(a):a};d.prototype.oa=function(){var a=this.kl();if(!a)return null;var b=a.trackWidth;return(a=a.trajectory)?new U(0,a.Zf(),b,a.Yf()):null};d.prototype.ga=function(){return this.Va?this.Va.lock():this.wDb()};d.prototype.sa=
function(a){if(null!=this.Va&&this.Va.Gi(a))return this;this.Lg();this.Va!==a&&(this.Va=null!=a?new U(a):a);this.xa();this.Lg();return this};d.prototype.wDb=function(){var a=this.kl();if(!a)return null;a=a.trajectory;return new U(a.mR(),a.nR(),a.qU(),a.rU())};d.prototype.zMd=function(){return this.mj.sza()};d.prototype.Ix=function(a){var b=this.kl();if(!b)return null;var c=[],e=b.trajectory;this.mj.qg.bK([new N(0,e.Zf()),new N(b.trackWidth,e.Zf()),new N(b.trackWidth,e.Yf()),new N(0,e.Yf()),new N(0,
e.Zf())],c,this.mj.Ce,!0);c=c.map(function(f){return a.transform(f)});return new uh(c.map(function(f){return f.getX()}),c.map(function(f){return f.getY()}))};d.prototype.DMd=function(){var a=this.kl();if(!a)return null;var b=a.trajectory;a=this.mj.tG(new N(a.trackWidth/2,b.Zf()),new N(a.trackWidth/2,b.Yf()));return Hd.getBoundingBox(a)};d.prototype.xa=function(a,b){Uh.prototype.xa.call(this,a,b);this.jm=null;return this};d.prototype.ge=function(){if(null!=this.jm)return this.jm;var a=this.ga(),b=
this.wDb();null!=b&&(0===b.ca()&&b.Qa(1),0===b.da()&&b.$a(1));null==a||a.isEmpty()||null==b||b.isEmpty()||(this.jm=X.Vd(b,a,!1,!1,!1));return this.jm};d.prototype.Xjc=function(a){var b=this.mj,c=[];a=[a.kd(),new N(a.na(),a.la()),a.yf(),new N(a.ka(),a.ma())];b.qg.bK(a,c,b.Ce,!0);return Hd.getBoundingBox(c)};d.prototype.Lg=function(a,b){if(!this.mj||!this.mj.oe)return this;var c=this.getParent();if(c){if(a){var e=this.Xjc(a);e=c.wa().wd(e)}else e=c.oa();c.ha(e,b)}if(this.JE)for(c=0;c<this.JE.length;++c)if(e=
this.JE[c])if("function"==typeof e)e.call(this,a,b);else e.onInvalidate(a,b);return this};d.prototype.getBoundingBox=function(a){a||(a=this.getParent()?this.getParent().wa():new X);var b=this.ga();if(null!=b){var c=this.ob();null!=c&&(b=c.Ua(b));b=a.Ua(b);c=this.kl();null!=c&&null!=c.trackWidth&&b.bd(c.trackWidth);b=a.sc(b)}return b};d.prototype.pf=function(a){if(!this.Ia())return!1;var b=this.ga();if(null!=b){var c=this.ob();null!=c&&(b=c.Ua(b));b=a.Ea().Ua(b);c=this.kl();null!=c&&null!=c.trackWidth&&
b.bd(c.trackWidth);if(!a.mg().Dd(b))return!1}return!0};d.prototype.render=function(a){if(this.kl()){a=null!=this.Sa()?a.bc(this.Sa()):a;a.save();this.Yh(a);this.mj.update(a);var b=a.mg(),c=a.Ea().wd(b);c=this.mj.aJa(c);if(c.isEmpty())this.yh(a),a.restore();else{if(this.mj.kl().clip){var e=this.Xjc(c);e=e.intersect(b);a.uh(e)}this.mj.Y_a(c);for(b=this.Df();b.wg();)c=b.next(),this.mj.filter(c)&&(this.mj.Sh(c),c.render(this.mj));this.yh(a);a.restore();d.kzd&&(c=this.kl().trajectory,this.mj.Sh(null),
this.mj.eJc(new Y("red",2)),this.mj.xba().qa(new Y("red",1)),this.mj.xba().ra(null),b=a.Ea().sc(this.zMd()),this.mj.xba().Bc(b),this.mj.xba().qa(new Y("black",2)),this.mj.Xc(this.kl().trackWidth/2,c.Zf(),this.kl().trackWidth/2,c.Yf()),this.mj.xba().qa(new Y("green",1)),b=a.Ea().sc(this.DMd()),this.mj.xba().Bc(b),this.mj.xba().qa(new Y("blue",1)),b=new U(0,c.Zf(),this.kl().trackWidth,c.Yf()),this.mj.Bc(b))}}else Uh.prototype.render.call(this,a)};d.prototype.Fe=function(a,b){if(this.kl()){var c=null!=
this.Sa()?a.bc(this.Sa()):a;c.save();this.mj.update(c);a=c.mg();var e=c.Ea().wd(a);e=this.mj.aJa(e);if(e.isEmpty())c.restore(),b();else{if(this.mj.kl().clip){var f=this.Xjc(e);f=f.intersect(a);c.uh(f)}this.mj.Y_a(e);var g=this;Hg.QN(this.Df(),function(h,k){g.mj.filter(h)?(g.mj.Sh(h),h.Fe(g.mj,k)):k()},function(){c.restore();d.GQe&&g.mj.eJc(new Y("red",2));b&&b()})}}else Uh.prototype.Fe.call(this,a,b)};d.prototype.JAd=function(a,b){if(null==this.mj)return null;this.mj.flb(this.wa());a=this.mj.aJa(a);
if(a.isEmpty())return null;b?b.vj(a.la(),a.ma()):b=new Kd(a.la(),a.ma());return b};d.prototype.F$c=function(){this.mj&&this.mj.flb(this.wa());return this};d.prototype.KMc=function(){if(null==this.mj)return null;this.mj.flb(this.wa());return this.mj.qg};d.prototype.wb=function(a){var b=this.getParent(),c=this.oa(),e=Si.kn();null!=b&&null!=b.oa()&&(e=new U(b.fj(a)),null!=this.mj&&null!=this.mj.qg&&(b=this.mj.qg.Ce.wd(e),e=this.mj.aJa(b)));if(null==c||e.isEmpty())return c;a||e.intersect(c);return e};
d.prototype.oda=function(a){null!=this.mj&&this.mj.oda(a);return this};d.prototype.Iza=function(){return null==this.mj?!1:this.mj.Iza()};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJvbkRldmlhdGlvbkNoYW5nZWQiOiJiWGMiLCJzZXREZXZpYXRpb24iOiJ0RCIsImdldERldmlhdGlvbiI6ImtsIiwic2hhbGxvd0Nsb25lIjoidk5hIiwiaW52ZXJzZVRyYW5zZm9ybSI6InNjIiwiZ2V0TW9kZWxMaW1pdHMiOiJvYSIsImdldEJvdW5kcyI6ImdhIiwic2V0Qm91bmRzIjoic2EiLCJnZXRUcmFqZWN0b3J5TGltaXRzIjoid0RiIiwiZ2V0T3V0bGluZSI6Ikl4IiwidXBkYXRlU3RhdGUiOiJ4YSIsImdldENvbnRlbnRzVHJhbnNmb3JtIjoiZ2UiLCJpbnZhbGlkYXRlUGFyZW50IjoiTGciLCJjaGVja0NvbGxpc2lvbiI6InBmIiwicmVuZGVyQXN5bmMiOiJGZSIsImZpbmREZXB0aFJhbmdlIjoiSkFkIiwiZ2V0RGV2aWF0ZWRUcmFuc2Zvcm1hdGlvbiI6IktNYyIsImdldFZpc2libGVNb2RlbExpbWl0cyI6IndiIiwic2V0V2ViR0xSZW5kZXJpbmciOiJvZGEiLCJnZXRXZWJHTFJlbmRlcmluZyI6Ikl6YSJ9fX0g");var iV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(f){f=xb(f,{fillstyle:null,alignment:O.Se,offset:0});Uh.call(this,f);this.ea=f;this.ea.children&&this.pa(this.ea.children);this.km=null;this.ik=f.deviatednode;this.ik.on(gV.z2a,this.tb());this.qg=null;this.HBc=new X}var a=X.xk,b=new N,c=new U,e=50;D(d,Uh);L(d,"geotoolkit.scene.DeviatedHeader");d.prototype.tb=function(){null==this.km&&(this.km=function(f,g,h){g===this.ik&&this.ha(void 0,!0);return this}.bind(this));return this.km};d.prototype.dispose=function(){this.te()||
(this.ik.za(gV.z2a,this.tb()),Uh.prototype.dispose.call(this))};d.prototype.F$c=function(f){f=f.Ea();if(this.qg)this.qg.update(f);else{var g=this.ik.kl();this.qg=g.transformer.create(g,f)}return this.qg};d.prototype.LMc=function(){var f=null;if(0<this.ac()){var g=this.gb(0);"function"===typeof g.Bl&&(f=g.Bl());f||"function"!==typeof g.ga||(f=g.ga());f&&(f.setX(0),f.setY(0),void 0!==this.ea.height&&f.$a(this.ea.height))}f||(f=this.ik.kl().trackWidth,g=void 0!==this.ea.height?this.ea.height:e,f=new U(0,
0,f,g));return f};d.prototype.jEd=function(f){var g=this.ik.kl().trackWidth;if(this.ea.alignment===O.Se){var h=-f;f=0}else h=0;return c.cb(-g/2,h,g/2,f)};d.prototype.pf=function(f){if(1>this.ac())return!1;var g=this.Std(f);this.HBc=X.multiply(f.Ea().xc(),g);g.Ua(this.LMc(),c);f=f.mg();return c.Dd(f)};d.prototype.Tc=function(f){if(f)throw Error("setLocalTransform is not allowed");return this};d.prototype.ge=function(){return this.HBc};d.prototype.Std=function(f){this.F$c(f);f=this.ik.oa();var g=this.ea.alignment===
O.Se?f.la():f.ma();b.Da(f.ka(),g);var h=this.qg.transform(b,a);b.Da(f.na(),g);var k=this.qg.transform(b,a);g=Math.atan2(k.getY()-h.getY(),k.getX()-h.getX());f=(k.getX()+h.getX())/2;h=(k.getY()+h.getY())/2;0!==this.ea.offset&&(k=this.ea.offset*Math.sin(-g),f+=k,k=this.ea.offset*Math.cos(-g),h+=k);k=this.LMc();k=X.Vd(k,this.jEd(k.da()));g=X.Ui(g,0,0);f=X.jf(f,h);g=X.multiply(g,k);X.multiply(f,g,g);return g};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRJbnZhbGlkYXRlTWV0aG9kIjoidGIiLCJjaGVja0NvbGxpc2lvbiI6InBmIiwic2V0TG9jYWxUcmFuc2Zvcm0iOiJUYyIsImdldENvbnRlbnRzVHJhbnNmb3JtIjoiZ2UifX19");var jV=/*#__PURE__*/function(){function d(a){hb("DeviationTool and inheritors are deprecated since 2020.1 (3.1) Use Carnac tools instead");SR.call(this,a);this.qg=this.ik=null;this.Sc=this.ab instanceof xm?this.ab.getParent():this.ab}D(d,SR);L(d,"geotoolkit.deviation.tools.DeviationTool");d.prototype.vXd=function(){var a=this.ik.kl(),b=this.ik.wa();this.qg=a.transformer.create(a,b)};d.prototype.ZWa=function(){if(null==this.ik){var a=ff(this.ab.getRoot()).vc(function(b){return b instanceof hV}).RO();null!=a&&0<
a.length&&(this.ik=a[0],this.ik.addListener(gV.z2a,function(){this.vXd()}.bind(this)))}return this.ik};return d}();var kV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(){ni.call(this);this.Fg(!1);this.Tj=new Bk;this.pa(this.Tj);this.Ue=(new ek({textstyle:new Fi})).nu(!0);this.pa(this.Ue);this.LS=0;this.Qs(bV.Oa);this.Nzc=null}D(d,ni);d.prototype.ha=function(a,b){this.Ia()&&(null==a?(this.Ue&&this.Lg(this.Ue.ga(),b),this.Tj&&this.Lg(this.Tj.ga(),b)):this.Lg(a,b));return this};d.prototype.setData=function(a,b,c){this.Nzc=c;this.Tj.xb(!1);this.Tj.Cr({from:a,to:b});this.Tj.xb(!0);this.Ue.xb(!1);var e=Math.atan2(b.getY()-a.getY(),b.getX()-
a.getX());a=this.tsb===bV.Oa?new N((a.getX()+b.getX())/2,(a.getY()+b.getY())/2):this.tsb===bV.tc?new N(a.getX(),a.getY()):new N(b.getX(),b.getY());c=null!=this.Ue.xpb?this.Ue.xpb(c.getX(),c.getY()):c.toString();this.Ue.Eb(c);0!==this.LS&&this.Ue.rotate(-this.LS,this.Ue.Wn(),this.Ue.Cm());this.Ue.Jb(a);this.LS=e;0!==this.LS&&this.Ue.rotate(this.LS,this.Ue.Wn(),this.Ue.Cm());this.Ue.xb(!0);this.ha();return this};d.prototype.getData=function(){return this.Nzc};d.prototype.pu=function(a){a&&(a.line&&
this.A2d(a.line),a.label&&this.$x(a.label));return this};d.prototype.A2d=function(a){void 0!==a.linestyle&&this.Tj.qa(a.linestyle);null!=a.visible&&this.Tj.va(a.visible)};d.prototype.Qs=function(a){this.tsb=a;this.tsb===bV.Oa?this.Ue.yc(O.Se):this.tsb===bV.tc?this.Ue.yc(O.hg):this.Ue.yc(O.Ah)};d.prototype.$x=function(a){void 0!==a.textstyle&&this.Ue.kb(a.textstyle);null!=a.visible&&this.Ue.va(a.visible);void 0!==a.textconverter&&(this.Ue.xpb=a.textconverter);null!=a.position&&this.Qs(a.position)};
return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJpbnZhbGlkYXRlIjoiaGEifX19");var lV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a,b){YR.call(this,a);this.Ie=b}D(d,YR);d.prototype.ec=function(){return this.Ie};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRQb3NpdGlvbiI6ImVjIn19fSAg");var mV=/*#__PURE__*/ta(/*#__PURE__*/{Ry:"onPositionChanged"},2,"eyJvblBvc2l0aW9uQ2hhbmdlZCI6IlJ5In0g"),nV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(c,e){jV.call(this,{slots:{pointermove:this.Ic.bind(this),"cg-leave":this.Oz.bind(this)},name:"string"===typeof e&&""!==e?e:"MD-cursor",layer:c instanceof ni||c instanceof xm||c&&"geotoolkit.schematics.scene.SimpleLayer"===c.Pa()?c:null});this.pta=new kV;this.pu({line:{linestyle:(new Y("black",1,[3,2])).Zg({x:!0,y:!0})}});this.ab.pa(this.pta);this.dga=null}var a=new N,b=new X;D(d,jV);L(d,"geotoolkit.deviation.tools.MDCursorTool");d.Ka=mV;d.prototype.tn=
function(){var c=this.isEnabled();this.pta.va(c);this.ab.ha();jV.prototype.tn.call(this)};d.prototype.pu=function(c){null!=c.enabled&&this.Rb(c.enabled);this.pta.pu(c);return this};d.prototype.dPe=function(c){this.setActive(!1)};d.prototype.Ic=function(c){if(this.isEnabled()){var e=this.ZWa();if(e){var f=e.kl();null!=f&&(e=e.wa(),this.qg?this.qg.update(e):this.qg=f.transformer.create(f,e),f=this.$ia(c),a.Da(f.x,f.y),f=this.qg.sc(a),isNaN(f.getX())||isNaN(f.getY())?(this.pta.va(!1),null!==this.dga&&
(this.dga=null,this.fireEvent(d.Ka.Ry,new lV(c,this.dga)))):(this.Wca(f),this.pta.va(!0),this.setActive(!0),null!=this.dga&&W.equals(this.dga.getY(),f.getY())&&W.equals(this.dga.getX(),f.getX())||(this.dga=f,this.fireEvent(d.Ka.Ry,new lV(c,this.dga)))))}}};d.prototype.Oz=function(c){this.fireEvent(RR.Oz,new lV(c,null))};d.prototype.update=function(){if(this.isEnabled()){var c=this.pta.getData(),e=this.ZWa();null!=c&&null!=e&&(this.qg.update(e.wa()),this.Wca(c))}};d.prototype.Wca=function(c){if(c){var e=
this.ZWa();if(e){var f=e.kl();if(f){e=e.wa();this.qg?this.qg.update(e):this.qg=f.transformer.create(f,e);a.Da(0,c.getY());e=this.qg.transform(a,b);f=f.trackWidth;a.Da(f,c.getY());f=this.qg.transform(a,b);var g=this.Sc.wa();null!=g&&(e=g.rd(e),f=g.rd(f));this.pta.setData(e,f,c)}}}else this.pta.va(!1),null!==this.dga&&(this.dga=null)};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJvbkFjdGl2ZVN0YXRlQ2hhbmdlZCI6InRuIiwic2V0U2V0dGluZ3MiOiJwdSIsInNldEN1cnNvciI6IldjYSJ9fX0g");var oV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a,b){YR.call(this,a);b=G(b,{},!0);void 0!==b.area&&(this.Uh=b.area);void 0!==b.startmd&&(this.Gqd=b.startmd);void 0!==b.endmd&&(this.mmd=b.endmd)}D(d,YR);L(d,"geotoolkit.deviation.tools.MDRubberBandEventArgs");d.prototype.pLd=function(){return this.Gqd};d.prototype.HEd=function(){return this.mmd};d.prototype.getArea=function(){return this.Uh};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRTdGFydE1EIjoicExkIiwiZ2V0RW5kTUQiOiJIRWQifX19");var pV=/*#__PURE__*/ta(/*#__PURE__*/{ANb:"md",Y3:"xy"},2,"eyJNRCI6IkFOYiIsIlhZIjoiWTMifSAg"),qV=/*#__PURE__*/function(){function d(f,g){this.Be=g||pV.Y3;g="md"===this.Be?{pointerdown:this.xTd.bind(this),pointermove:this.zTd.bind(this),pointerup:this.BTd.bind(this)}:{pointerdown:this.yTd.bind(this),pointermove:this.ATd.bind(this),pointerup:this.CTd.bind(this)};jV.call(this,{slots:g,layer:f,name:"MD-rubberband"});this.Rb(!1);this.d5=!0;this.tga=(new Um).va(!1).qa((new Y(a,1,[2,3])).Zg({x:!1,y:!1})).ra(new rf(b));null!=this.ab&&this.ab.pa(this.tga);this.$9a=(new ho(new U(0,0,0,
0))).va(!1).qa((new Y("red",2)).Zg({x:!0,y:!0})).ra(null);null!=this.ab&&this.ab.pa(this.$9a);this.JK=null;this.zx=NaN;this.Ib=0;this.KW=this.kT=NaN;this.mxb=new N;this.lxb=new N;this.B9a=new U}var a="#bdbdbd",b="rgba(189,189,189,0.5)",c=new N,e=new X;D(d,jV);L(d,"geotoolkit.deviation.tools.MDRubberBand");d.sw=pV;d.prototype.r8d=function(){var f=this.ZWa();if(!f)return null;var g=f.kl(),h=f.wa();this.qg?this.qg.update(h):this.qg=g.transformer.create(g,h);this.zx=g.trackWidth;this.Ib=g.offset;return f};
d.prototype.c2b=function(f){var g=this.ZWa();if(!g)return c.Da(NaN,NaN);var h=g.kl();g=g.wa();this.qg?this.qg.update(g):this.qg=h.transformer.create(h,g);this.zx=h.trackWidth;this.Ib=h.offset;f=this.$ia(f);c.Da(f.x,f.y);return this.qg.sc(c)};d.prototype.xTd=function(f){var g=this.c2b(f);isNaN(g.getX())||isNaN(g.getY())||(f.stopPropagation(!0),this.setActive(!0),this.kT=g.getY(),this.fireEvent(kU.Ka.NR,new oV(f,{startMD:this.kT})))};d.prototype.BTd=function(f){if(this.Pd()){var g=this.c2b(f);isNaN(g.getX())||
isNaN(g.getY())?this.Pd()&&(this.setActive(!1),this.tga.va(!1).ha()):(f.stopPropagation(!0),this.setActive(!1),this.tga.va(!1).ha(),this.fireEvent(kU.Ka.cra,new oV(f,{startMD:this.kT,endMD:this.KW})),g=new U(this.wTa.getX(),this.wTa.getY(),this.xTa.getX(),this.xTa.getY()),this.fireEvent(kU.Ka.gw,new oV(f,{area:g})),this.d5&&this.Rb(!1))}};d.prototype.b2c=function(){var f=this.Sc.wa(),g=null;f&&(g=f.xc());var h=[new N(0,this.kT),new N(this.zx,this.kT),new N(this.zx,this.KW),new N(0,this.KW)];f=[];
this.qg.bK(h,f,e,!0);c.Da(this.zx/2-this.Ib,this.kT);this.wTa=this.qg.transform(c,e);c.Da(this.zx/2-this.Ib,this.KW);this.xTa=this.qg.transform(c,e);if(g)for(g.Ma(this.wTa,this.wTa),g.Ma(this.xTa,this.xTa),h=0;h<f.length;++h)g.Ma(f[h],f[h]);var k=[],l=[];f.forEach(function(m){k.push(m.getX());l.push(m.getY())});this.tga.ne(k,l)};d.prototype.zTd=function(f){if(this.Pd()){var g=this.c2b(f);isNaN(g.getX())||isNaN(g.getY())||(f.stopPropagation(!0),this.KW=g.getY(),this.b2c(),this.tga.va(!0).ha(),this.fireEvent(kU.Ka.cra,
new oV(f,{startMD:this.kT,endMD:this.KW})))}};d.prototype.yTd=function(f){this.OCc=this.Sd(this.ab,f);var g=this.$ia(f);this.mxb.Da(Math.round(g.x),Math.round(g.y));f.stopPropagation(!0);this.setActive(!0);this.r8d()};d.prototype.CTd=function(f){if(this.Pd()&&(f.stopPropagation(!0),this.setActive(!1),this.tga.va(!1).ha(),this.$9a.va(!1).ha(),!isNaN(this.KW)&&!isNaN(this.kT))){this.fireEvent(kU.Ka.cra,new oV(f,{startMD:this.kT,endMD:this.KW}));var g=new U(this.wTa.getX(),this.wTa.getY(),this.xTa.getX(),
this.xTa.getY());this.fireEvent(kU.Ka.gw,new oV(f,{area:g}));this.d5&&this.Rb(!1)}};d.prototype.OAa=function(f,g){c.Da(f,g);f=this.qg.sc(c).getY();isNaN(f)||(f<this.kT&&(this.kT=f),f>this.KW&&(this.KW=f))};d.prototype.hud=function(){var f=this.ZWa();if(f){this.kT=Number.POSITIVE_INFINITY;this.KW=Number.NEGATIVE_INFINITY;var g=this.B9a.la();f=this.B9a.ma();for(var h=this.B9a.ka(),k=this.B9a.na(),l=h;l<k;l+=10)this.OAa(l,g),this.OAa(l,f);this.OAa(k,g);for(this.OAa(k,f);g<f;g+=10)this.OAa(h,g),this.OAa(k,
g);this.OAa(h,f);this.OAa(k,f)}else this.KW=this.kT=NaN};d.prototype.ATd=function(f){if(this.Pd()){var g=this.$ia(f);this.lxb.Da(Math.round(g.x),Math.round(g.y));if(this.lxb.x!==this.mxb.x&&this.lxb.y!==this.mxb.y){g=function(k,l,m){k.cb(Math.min(l.x,m.x),Math.min(l.y,m.y),Math.max(l.x,m.x),Math.max(l.y,m.y))};g(this.B9a,this.mxb,this.lxb);var h=this.Sd(this.ab,f);!1===this.$9a.Ia()&&this.OCc.Ex(h)||(this.Frd=h,g(this.$9a,this.OCc,this.Frd),this.$9a.va(!0).ha(),this.hud(),isNaN(this.KW)||isNaN(this.kT)?
this.tga.va(!1).ha():(this.b2c(),this.tga.va(!0).ha()),f.stopPropagation(!0),this.fireEvent(kU.Ka.cra,new oV(f,{startMD:this.kT,endMD:this.KW})))}}};d.prototype.setOptions=function(f){null!=f.enabled&&this.Rb(f.enabled);void 0!==f.linestyle&&this.tga.qa(f.linestyle);void 0!==f.fillstyle&&this.tga.ra(f.fillstyle);null!=f.autodisabled&&(this.d5=f.autodisabled);void 0!==f.mode&&(this.Be=f.mode);return this};return d}();var rV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(e,f,g,h,k){g=(k-h)/(g-f);return g*(e-f)+h}function a(e,f){return e&&f&&e.Vaa()===f.Vaa()&&e.cd()===f.cd()}function b(e,f,g,h,k,l){void 0!==h&&hb("geotoolkit.deviation.Trajectory2d parameter minDepth deprecated since 2020 (3.0). minDepth is calculated inside");void 0!==k&&hb("geotoolkit.deviation.Trajectory2d parameter maxDepth deprecated since 2020 (3.0). maxDepth is calculated inside");void 0!==l&&hb("geotoolkit.deviation.Trajectory2d parameter approximate deprecated since 2021.1 (3.3). Use properties object instead (x.options.approximate)");
this.eJ=Zd.ya();this.ea={approximate:l||!0,depthinterval:c,units:{distance:"ft"}};e&&!Array.isArray(e)&&(g=e.data,h=e.options,e=g.x,f=g.y,g=g.d,G(h,this.ea));this.Y$a=this.waa=this.vaa=null;this.Cja({x:e,y:f,d:g})}var c=.001;L(b,"geotoolkit.deviation.Trajectory2d");b.prototype.Cja=function(e){var f=e.x,g=e.y;e=e.d;if(!(!f||1>f.length||!g||1>g.length||f.length!==g.length)){var h;if(!e)for(e=[0],h=1;h<f.length;h++){var k=f[h]-f[h-1],l=g[h]-g[h-1];e.push(e[h-1]+Math.sqrt(k*k+l*l))}this.dc=[f[0]];this.rc=
[g[0]];this.Ag=[e[0]];k=new N;l=new N;for(h=1;h<e.length;h++)Math.abs(e[h]-e[h-1])<this.ea.depthinterval||(k.Da(f[h-1],g[h-1]),l.Da(f[h],g[h]),N.xf(k,l)<W.Tb||(this.dc.push(f[h]),this.rc.push(g[h]),this.Ag.push(e[h])));this.dI(this.ea.units);this.Ykb();this.WHe=this.ea.approximate}};b.prototype.n8d=function(e,f,g,h,k,l){if(e&&!a(e,f)&&e.Tm(f)){var m=[];this.dc.forEach(function(q){q=e.convert(q,f);m.push(q)});this.dc=m}if(g&&!a(g,h)&&g.Tm(h)){var n=[];this.rc.forEach(function(q){q=g.convert(q,h);n.push(q)});
this.rc=n}if(k&&!a(k,l)&&k.Tm(l)&&this.vaa===this.waa){var p=[];this.Ag.forEach(function(q){q=k.convert(q,l);p.push(q)});this.Ag=p}this.Ykb()};b.prototype.dI=function(e){if(!e)return this;var f=this.vaa,g=this.waa,h=this.Y$a;if(e.distance){var k=this.eJ.Xa(e.distance);if(!k||!k.CB("length"))throw new TypeError("distance-unit must belong to length units!");this.Y$a=this.waa=this.vaa=k;this.ea.units.x=e.distance;this.ea.units.y=e.distance}else{f||e.x||(e.x=e.y);g||e.y||(e.y=e.x);if(e.x){k=this.eJ.Xa(e.x);
if(!k||!k.CB("length"))throw new TypeError("x-unit must belong to length units!");this.vaa=k;this.ea.units.x=e.x}if(e.y){k=this.eJ.Xa(e.y);if(!k||!k.CB("length"))throw new TypeError("y-unit must belong to length units!");this.waa=k;this.ea.units.y=e.y}}this.n8d(f,this.vaa,g,this.waa,h,this.Y$a);return this};b.prototype.ADb=function(){this.vaa||this.dI(this.ea.units);return this.vaa};b.prototype.BDb=function(){this.waa||this.dI(this.ea.units);return this.waa};b.prototype.NMd=function(){this.Y$a||this.dI(this.ea.units);
return this.Y$a};b.prototype.tYa=function(){return xb(this.ea.units,{})};b.Ra=function(e){if(!e)return null;if(e instanceof b)return e.id=ye.Mz(),e;var f=e.md;f=new b({data:{x:e.x,y:e.y,d:f}});void 0===e.id&&(e.id=ye.Mz());f.id=e.id;return f};b.prototype.Ykb=function(){this.jo=Math.min.apply(null,this.dc);this.it=Math.max.apply(null,this.dc);this.ko=Math.min.apply(null,this.rc);this.jt=Math.max.apply(null,this.rc);this.Rr=Math.min.apply(null,this.Ag);this.As=Math.max.apply(null,this.Ag)};b.prototype.hUc=
function(e,f){var g=this.Ag.length;if(2>g)return hb("Can not extrapolate: less than 2 stations!"),null;f||(f=new N);if(e<=this.Ag[0]){var h=0;var k=1}else if(e>=this.Ag[g-1])h=g-2,k=g-1;else for(var l=1;l<g;++l)if(e<this.Ag[l]){h=l-1;k=l;break}g=d(e,this.Ag[h],this.Ag[k],this.dc[h],this.dc[k]);e=d(e,this.Ag[h],this.Ag[k],this.rc[h],this.rc[k]);f.Da(g,e);return f};b.prototype.HJc=function(e){if(2>this.Ag.length)return rb("Can not extrapolate: less than 2 stations!"),!1;var f=1,g=0,h=d(e,this.Ag[f],
this.Ag[g],this.dc[f],this.dc[g]);f=d(e,this.Ag[f],this.Ag[g],this.rc[f],this.rc[g]);Math.abs(e-this.Ag[g])<this.ea.depthinterval?(this.dc[g]=h,this.rc[g]=f,this.Ag[g]=e):(this.dc.unshift(h),this.rc.unshift(f),this.Ag.unshift(e));this.Ykb();return!0};b.prototype.IJc=function(e){if(2>this.Ag.length)return rb("Can not extrapolate: less than 2 stations!"),!1;var f=this.dc.length-2,g=this.dc.length-1,h=d(e,this.Ag[f],this.Ag[g],this.dc[f],this.dc[g]);f=d(e,this.Ag[f],this.Ag[g],this.rc[f],this.rc[g]);
Math.abs(e-this.Ag[g])<this.ea.depthinterval?(this.dc[g]=h,this.rc[g]=f,this.Ag[g]=e):(this.dc.push(h),this.rc.push(f),this.Ag.push(e));this.Ykb();return!0};b.prototype.getX=function(e){return this.dc[e]};b.prototype.getY=function(e){return this.rc[e]};b.prototype.Ub=function(e){return this.Ag[e]};b.prototype.count=function(){return this.dc?this.dc.length:0};b.prototype.Zf=function(){return this.Rr};b.prototype.Yf=function(){return this.As};b.prototype.WOc=function(e,f,g){return new dV(this,e,new N(g,
f))};b.gxd=function(e,f,g,h,k,l,m){g=c;var n={distance:"ft",angle:"deg"};if(!Array.isArray(e)){f=e.data;var p=e.options;e=f.md;f=f.inclination;p=xb(p,{rightDeviation:!0,start:0,filter:!0,approximate:!0,depthinterval:g,units:n});h=p.rightDeviation;k=p.start;l=p.filter;m=p.approximate;g=p.depthinterval;n=p.units}if(!e||!f||e.length!==f.length)return null;var q;for(q=0;q<e.length-1;++q)if(e[q+1]<e[q])return null;p=new N;var r=new N,t=new N;k=k||0;l=void 0!==l?l:!0;m=void 0!==m?m:!0;h=void 0!==h?h:!0;
q=Zd.ya();var u=q.Xa(n.angle),w=q.Xa("rad"),y=e.length,z=[],x=[],C=[],A=e[0],v=0;for(q=0;q<y;q++){var B=h?f[q]:-f[q];B=u.convert(B,w);if(0===q){z[0]=k;x[0]=A;C[0]=e[q];var E=B;var H=e[q];var F=e[q]}else{var I=e[q]-C[v];k+=I*Math.sin(E);A+=I*Math.cos(E);if(l){if(0<=v){p.Da(z[v-1],x[v-1]);r.Da(z[v],x[v]);t.Da(k,A);E=N.xf(r,t);var J=E<W.Tb,K=0<v&&!J&&cP.P$b(p,r,t);J||(K?(J=N.xf(p,r),(E=Math.abs(E/J-I/(C[v]-C[v-1]))<W.Tb)||++v):++v,z[v]=k,x[v]=A,C[v]=e[q])}}else++v,z[v]=k,x[v]=A,C[v]=e[q];E=B;C[v]>H&&
(H=C[v]);C[v]<F&&(F=C[v])}}return 0<v?new b({data:{x:z,y:x,d:C},options:{approximate:m,depthinterval:g,units:n}}):null};b.prototype.mR=function(){return this.jo};b.prototype.nR=function(){return this.ko};b.prototype.qU=function(){return this.it};b.prototype.rU=function(){return this.jt};b.prototype.BGb=function(e,f){if(0>e||e>this.dc.length-1)throw Error("Removal index out of bounds");void 0===f&&(f=1);0!==f&&(this.dc.splice(e,f),this.rc.splice(e,f),this.Ag.splice(e,f),this.Ykb())};b.gKc=function(e,
f,g){var h,k;for(h=g;h<e.count();++h)for(k=g;k<f.count();++k)if(e.dc[h]===f.dc[k]&&e.rc[h]===f.rc[k])return{pKc:h,P0c:k};return null};b.lYd=function(e,f){if(!(1>e.count()||1>f.count())&&e.dc[0]===f.dc[0]&&e.rc[0]===f.rc[0])for(var g=0,h;;){h=-1;for(var k=Math.min(e.count(),f.count());g<k;++g)if(e.dc[g]!==f.dc[g]||e.rc[g]!==f.rc[g]){h=g;break}if(-1===h)break;if(k=b.gKc(e,f,h))e.BGb(k.pKc-h),f.BGb(k.P0c-h);else if(k=b.gKc(f,e,h))e.BGb(k.P0c-h),f.BGb(k.pKc-h);if(!k)break;g=h}};b.yYd=function(e){!e||
2>e.length||2===e.length&&b.lYd(e[0],e[1])};b.prototype.equals=function(e){if(!e||this.count()!==e.count()||this.mR()!==e.mR()||this.qU()!==e.qU()||this.nR()!==e.nR()||this.rU()!==e.rU())return!1;for(var f=0;f<this.count();f++)if(this.getX(f)!==e.getX(f)||this.getY(f)!==e.getY(f)||this.Ub(f)!==e.Ub(f))return!1;return!0};b.prototype.ia=function(){var e={};e.options=xb(this.ea,{});return e};b.prototype.fa=function(e){e=jc(e);if(null==e)return this;void 0!==e.options&&G(e.options,this.ea);void 0!==e.data&&
this.Cja(e.data);return this};return b}(),2,"eyJmcm9tT2JqZWN0IjoiUmEiLCJjcmVhdGVUcmFqZWN0b3J5IjoiZ3hkIiwicHJvdG90eXBlIjp7InMiOjAsImMiOnsiaW50ZXJwb2xhdGVYWSI6ImhVYyIsImdldERlcHRoIjoiVWIiLCJtaW5EZXB0aCI6IlpmIiwibWF4RGVwdGgiOiJZZiIsImdldE1pblgiOiJtUiIsImdldE1pblkiOiJuUiIsImdldE1heFgiOiJxVSIsImdldE1heFkiOiJyVSIsImdldFByb3BlcnRpZXMiOiJpYSIsInNldFByb3BlcnRpZXMiOiJmYSJ9fX0g");var sV=/*#__PURE__*/function(){function d(){gP.call(this);this.YM=null;this.ad=new X;this.r=new U;this.cwb=new N}D(d,gP);L(d,"geotoolkit.deviation.TVDTrajectoryStation");d.prototype.Sf=function(){return this.r};d.prototype.kd=function(){return this.ad.Ma(this.cwb.Da(this.r.ka(),this.r.la()))};d.prototype.dg=function(){return this.ad.Ma(this.cwb.Da(this.r.ka(),this.r.ma()))};d.prototype.fg=function(){return this.ad.Ma(this.cwb.Da(this.r.na(),this.r.la()))};d.prototype.yf=function(){return this.ad.Ma(this.cwb.Da(this.r.na(),
this.r.ma()))};d.prototype.k2=function(){return this.YM=this.YM||this.ad.xc()};d.prototype.Ea=function(){return this.ad};d.prototype.Sb=function(a){this.ad=a;this.YM=null;this.u2b();return this};d.prototype.offset=function(a,b){this.ad.TA(this.ad.cf()+a,this.ad.Pe()+b);this.YM=null;return this};d.prototype.A7d=function(){var a=this.r.ka(),b=this.r.na(),c=this.r.la(),e=this.r.ma(),f=this.ad.Pc(a,e),g=f.getX();f=f.getY();var h=this.ad.Pc(b,c),k=h.getX();h=h.getY();a=this.ad.Pc(a,c);c=a.getX();a=a.getY();
b=this.ad.Pc(b,e);var l=b.getX();e=b.getY();b=Math.min(Math.min(g,k),Math.min(c,l));g=Math.max(Math.max(g,k),Math.max(c,l));k=Math.min(Math.min(f,h),Math.min(a,e));f=Math.max(Math.max(f,h),Math.max(a,e));return new U(b,k,g,f)};d.prototype.contains=function(a){a=this.k2().Ma(a);return this.r.contains(a)};d.prototype.sc=function(a){return this.k2().Ma(a)};d.prototype.transform=function(a){return this.ad.Ma(a)};d.prototype.Maa=function(a,b){return this.tbc(a,b)};return d}();var tV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(b,c,e){$O.call(this);this.Ce=b.transformation||e;this.Aq=b.trajectory;this.zx=b.trackWidth;this.Cf=b.filter;this.Ib=b.offset;c=G(c,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1});this.HYb=c.scaleWidth;this.PW=c.minWidth;this.JW=c.maxWidth;this.ixb=c.widthScaleX;this.Ge=[];this.iH=new ZO;this.Lfa=this.Kfa=this.iT=this.hT=1;this.JBc=new X;this.KBc=new X;this.tra();this.Va=null}var a=cP;D(d,$O);L(d,"geotoolkit.deviation.TVDTransformation");
d.prototype.Q1=function(b){var c=this.Ge.length,e=W.findIndex(null,this.Ge,0,c,function(f){f=f.r.ma()-b;return Math.abs(f)>W.Tb?f:0});0>e?e=~e:++e;e>=c&&(e=c-1);return e};d.prototype.update=function(b){if(Math.abs(b.lb()-this.Ce.lb())>W.Tb||Math.abs(b.Ab()-this.Ce.Ab())>W.Tb)this.Ce=b,this.tra();else{var c=b.cf()-this.Ce.cf(),e=b.Pe()-this.Ce.Pe();if(Math.abs(c)>W.Tb||Math.abs(e)>W.Tb){for(var f=0;f<this.Ge.length;++f)this.Ge[f].offset(c,e);this.JBc.Sb(1,0,0,1,c,e);c=this.iH.aqa();for(e=0;e<c.length;++e)f=
c[e],this.JBc.Ua(f.tw.i8,f.tw.i8)}this.Ce=b}return!0};d.prototype.transform=function(b){var c=this.Q1(b.getY());for(0>c&&(c=0);c<this.Ge.length;++c){if(b.getY()<=this.Ge[c].r.ma()&&b.getY()>=this.Ge[c].r.la())return this.Ge[c].transform(b);if(this.Ge[c].r.ma()>b.getY())break}return new N};d.prototype.sc=function(b){for(var c=this.iH.aqa(),e=this.iH.wZa(b.getY()-this.Ce.Pe());e<c.length;++e){var f=c[e];if(this.Ge[f.tw.zsa].contains(b))return this.Ge[f.tw.zsa].sc(b);if(b.getY()<f.tw.i8.ma())break}return new N};
d.prototype.tG=function(b,c,e){if(0!==this.Ge.length){var f=new N,g=this.Q1(b.getY());if(b.getY()<=c.getY())for(;g<this.Ge.length;++g){var h=this.Ge[g];h.r.la()<=b.getY()&&h.r.ma()>=b.getY()&&a.Ar(e,h.transform(b),f,this.Cf);h.r.la()>=b.getY()&&h.r.la()<=c.getY()&&a.Ar(e,h.transform(a.GR(b,c,h.r.la())),f,this.Cf);g===this.Ge.length-1&&h.r.ma()>=b.getY()&&h.r.ma()<=c.getY()&&a.Ar(e,h.transform(a.GR(b,c,h.r.ma())),f,this.Cf);h.r.la()<=c.getY()&&h.r.ma()>=c.getY()&&a.Ar(e,h.transform(c),f,this.Cf);if(h.r.ma()>=
c.getY())break}else for(g>=this.Ge.length&&(g=this.Ge.length-1);0<=g&&!(h=this.Ge[g],h.r.la()<=b.getY()&&h.r.ma()>=b.getY()&&a.Ar(e,h.transform(b),f,this.Cf),h.r.ma()>=c.getY()&&h.r.ma()<=b.getY()&&a.Ar(e,h.transform(a.GR(b,c,h.r.ma())),f,this.Cf),0===g&&h.r.la()>=c.getY()&&h.r.la()<=b.getY()&&a.Ar(e,h.transform(a.GR(b,c,h.r.la())),f,this.Cf),h.r.la()<=c.getY()&&h.r.ma()>=c.getY()&&a.Ar(e,h.transform(c),f,this.Cf),h.r.la()<=c.getY());--g);}};d.prototype.bK=function(b,c,e,f){var g=b.length;if(1<g&&
0<this.Ge.length){(f=f&&!a.KYc(b,g))&&++g;if(e){var h=e.lb();var k=e.Ab();var l=e.cf();e=e.Pe()}else k=h=1,e=l=0;for(var m=new N,n=new N(b[0].getX()*h+l,b[0].getY()*k+e),p=new N,q=0,r=0,t,u=0;u<g-1;++u){t=f&&u===g-2?0:u+1;p.Da(b[t].getX()*h+l,b[t].getY()*k+e);if(0>q||q>=this.Ge.length||!(this.Ge[q].r.la()<=n.getY()&&this.Ge[q].r.ma()>=n.getY()))q=this.Q1(n.getY());if(n.getY()<=p.getY())for(;q<this.Ge.length&&!(t=this.Ge[q],0===u&&t.r.la()<=n.getY()&&t.r.ma()>=n.getY()&&a.Ar(c,t.transform(n),m,this.Cf),
t.r.la()>n.getY()&&t.r.la()<p.getY()&&a.Ar(c,t.transform(a.GR(n,p,t.r.la())),m,this.Cf),q===this.Ge.length-1&&t.r.ma()>n.getY()&&t.r.ma()<p.getY()&&a.Ar(c,t.transform(a.GR(n,p,t.r.ma())),m,this.Cf),t.r.la()<=p.getY()&&t.r.ma()>=p.getY()&&(a.Ar(c,t.transform(p),m,this.Cf),r=q),t.r.ma()>=p.getY());++q);else for(q>=this.Ge.length&&(q=this.Ge.length-1);0<=q&&!(t=this.Ge[q],0===u&&t.r.la()<=n.getY()&&t.r.ma()>=n.getY()&&a.Ar(c,t.transform(n),m,this.Cf),t.r.ma()>p.getY()&&t.r.ma()<n.getY()&&a.Ar(c,t.transform(a.GR(n,
p,t.r.ma())),m,this.Cf),0===q&&t.r.la()>p.getY()&&t.r.la()<n.getY()&&a.Ar(c,t.transform(a.GR(n,p,t.r.la())),m,this.Cf),t.r.la()<=p.getY()&&t.r.ma()>=p.getY()&&(a.Ar(c,t.transform(p),m,this.Cf),r=q),t.r.la()<=p.getY());--q);q=r;n.Da(p.getX(),p.getY())}}};d.prototype.iya=function(b){return null};d.prototype.zWa=function(b){return 1>this.Ge.length?new U:new U(0,b.la(),this.zx,b.ma())};d.prototype.contains=function(b){for(var c=this.iH.aqa(),e=this.iH.wZa(b.getY()-this.Ce.Pe());e<c.length;++e){var f=
c[e];if(f.tw.i8.contains(b)&&this.Ge[f.tw.zsa].contains(b))return!0;if(b.getY()<f.tw.i8.ma())break}return!1};d.prototype.kZ=function(b){return this.hT};d.prototype.lZ=function(b){return this.iT};d.prototype.QY=function(){return this.hT};d.prototype.RY=function(){return this.iT};d.prototype.WU=function(){return this.Kfa};d.prototype.XU=function(){return this.Lfa};d.prototype.Maa=function(b,c){var e=this.Q1(b.getY());for(0>e&&(e=0);e<this.Ge.length;++e){if(b.getY()<=this.Ge[e].r.ma()&&b.getY()>=this.Ge[e].r.la())return this.Ge[e].Maa(b,
c);if(this.Ge[e].r.ma()>b.getY())break}return null};d.prototype.x_d=function(b){return this.HYb};d.prototype.tra=function(){this.Ge=[];this.iH.clear();for(var b=0,c=this.x_d(Math.abs(this.Ce.lb())),e=1;e<this.Aq.count();++e)if(!(this.Aq.getY(b)>=this.Aq.getY(e))){var f=this.Aq.getX(b),g=this.Aq.getY(b),h=this.Aq.getX(e),k=this.Aq.getY(e);if(1<e&&e<this.Aq.count()-1){var l=new N(f,g),m=new N(h,k),n=this.Ce.Ma(l),p=this.Ce.Ma(m);if(.5>Math.abs(n.getX()-p.getX())&&.5>Math.abs(n.getY()-p.getY()))continue;
if(1<b&&(n=new N(this.Aq.getX(b-1),this.Aq.getY(b-1)),a.P$b(n,m,l)))continue}h=(h-f)/(k-g);f-=h*g;g=new sV;this.KBc.Sb(c,0,h,1,f,0);g.Sb(X.multiply(this.Ce,this.KBc));g.r=new U(0,this.Aq.getY(b),this.zx,this.Aq.getY(e));this.dIa(g);b=e}this.hT=Math.abs(c*this.Ce.lb());this.iT=Math.abs(this.Ce.Ab());this.Kfa=Math.abs(c*this.Ce.lb());this.Lfa=Math.abs(this.Ce.Ab())};d.prototype.dIa=function(b){var c=b.A7d(),e=new mP(this.Ge.length,c);c=c.ma()-this.Ce.Pe();this.iH.vo(new nP(c,e));this.Ge.push(b)};d.prototype.cdb=
function(){return this.Ce};d.prototype.sza=function(){if(!this.Va){var b=null;this.Ge.forEach(function(c){b?b.union(c.ga()):b=c.ga()});this.Va=b}return this.Va};return d}(),1,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRMb3dlckluZGV4IjoiUTEiLCJpbnZlcnNlVHJhbnNmb3JtIjoic2MiLCJ0cmFuc2Zvcm1MaW5lIjoidEciLCJ0cmFuc2Zvcm1MaW5lcyI6ImJLIiwiZmluZFZpc2libGVUcmFqZWN0b3J5UmFuZ2VzIjoiaXlhIiwiZmluZEJvdW5kcyI6InpXYSIsInNjYWxlWEF0Ijoia1oiLCJzY2FsZVlBdCI6ImxaIiwibWF4U2NhbGVYIjoiUVkiLCJtYXhTY2FsZVkiOiJSWSIsIm1pblNjYWxlWCI6IldVIiwibWluU2NhbGVZIjoiWFUiLCJkaWdpdGl6ZSI6Ik1hYSIsImdldFN0YXRpb25zQm91bmRzIjoic3phIn19fSAg");var uV=/*#__PURE__*/ta(/*#__PURE__*/function(){function d(a){YO.call(this);this.ea=G(a,{scaleWidth:!1,minWidth:-Number.MAX_VALUE,maxWidth:Number.MAX_VALUE,widthScaleX:1})}D(d,YO);L(d,"geotoolkit.deviation.TVDTransformer");d.prototype.ta=function(){return G(this.ea,{})};d.prototype.setOptions=function(a){G(a,this.ea)};d.prototype.create=function(a,b){return new tV(a,this.ea,b)};return d}(),2,"eyJwcm90b3R5cGUiOnsicyI6MCwiYyI6eyJnZXRPcHRpb25zIjoidGEifX19");export {YO,ZO,$O,aP,bP,cP,dP,eP,fP,gP,hP,iP,jP,kP,lP,mP,nP,oP,pP,qP,rP,$U,aV,bV,cV,dV,eV,fV,gV,hV,iV,jV,kV,lV,mV,nV,oV,pV,qV,rV,sV,tV,uV};